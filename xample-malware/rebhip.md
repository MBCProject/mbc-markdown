<table>
<tr>
<td><b>ID</b></td>
<td><b>X0015</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2011</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b>None</b></td>
</tr>
</table>


# Redhip

An information stealer.

## ATT&CK Techniques

|Name|Use|
|---|---|
|[Credential Access::Credentials from Password Stores::Windows Credential Manager (T1555.004)](https://attack.mitre.org/techniques/T1555/004)|Acquire credentials from Windows Credential Manager (This capa rule had 3 matches) [[2]](#2) |
|[Defense Evasion::File and Directory Permissions Modification (T1222)](https://attack.mitre.org/techniques/T1222)|Set file attributes (This capa rule had 1 match) [[2]](#2) |
|[Defense Evasion::Virtualization/Sandbox Evasion::System Checks (T1497.001)](https://attack.mitre.org/techniques/T1497/001)|Reference anti-VM strings targeting VirtualBox (This capa rule had 1 match) [[2]](#2) |
|[Discovery::Account Discovery (T1087)](https://attack.mitre.org/techniques/T1087)|Get user security identifier (This capa rule had 1 match) [[2]](#2) |
|[Discovery::System Owner/User Discovery (T1033)](https://attack.mitre.org/techniques/T1033)|Get session user name (This capa rule had 3 matches) [[2]](#2) |
|[Execution::Shared Modules (T1129)](https://attack.mitre.org/techniques/T1129)|Access PEB ldr_data (This capa rule had 1 match) [[2]](#2) |


## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Anti-Static Analysis::Software Packing (F0001)](../anti-static-analysis/software-packing.md)|Redhip samples are packed with different custom packers. [[1]](#1) |
|[Collection::Keylogging::Application Hook (F0002.001)](../collection/keylogging.md)|Log keystrokes via application hook (This capa rule had 1 match) [[2]](#2) |
|[Collection::Keylogging::Polling (F0002.002)](../collection/keylogging.md)|Log keystrokes via polling (This capa rule had 1 match) [[2]](#2) |
|[Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm (E1027.m02)](../defense-evasion/obfuscated-files-or-information.md)|Encode data using XOR (This capa rule had 1 match) [[2]](#2) |
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|Get file size (This capa rule had 3 matches) [[2]](#2) |
|[Persistence::Registry Run Keys / Startup Folder (E1547.001)](../persistence/registry-run-keys-startup-folder.md)|Persist via Run registry key (This capa rule had 4 matches) [[2]](#2) |
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|Check OS version (This capa rule had 1 match) [[2]](#2) |
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|Accept command line arguments (This capa rule had 1 match) [[2]](#2) |
|[Defense Evasion::Process Injection::Thread Execution Hijacking (E1055.003)](../defense-evasion/process-injection.md)|Inject thread (This capa rule had 1 match) [[2]](#2) |

## MBC Behaviors

|Name|Use|
|---|---|
|[Anti-Behavioral Analysis::Sandbox Detection::Product Key/ID Testing (B0007.005)](../anti-behavioral-analysis/sandbox-detection.md)|Redhip detects all publicly available automated malware analysis workbenches (ThreatExpert, JoeBox, etc.) by considering OS product keys and special DLLs. [[1]](#1) check for sandbox and av modules (This capa rule had 2 matches) [[2]](#2) |
|[Anti-Behavioral Analysis::Virtual Machine Detection (B0009)](../anti-behavioral-analysis/virtual-machine-detection.md)|Redhip detects VMWare, Virtual PC and Virtual Box. It also detects VM environments in general by considering timing lapses. [[1]](#1) |
|[Anti-Behavioral Analysis::Debugger Detection (B0001)](../anti-behavioral-analysis/debugger-detection.md)|Redhip uses general approaches to detecting user level debuggers (e.g., Process Environment Block 'Being Debugged' field), as well as specific checks for kernel level debuggers like SOFICE. [[1]](#1) |
|[Anti-Behavioral Analysis::Debugger Evasion (B0002)](../anti-behavioral-analysis/debugger-evasion.md)|Redhip uses general approaches to detecting user level debuggers (e.g., Process Environment Block 'Being Debugged' field), as well as specific checks for kernel level debuggers like SOFICE. [[1]](#1) |
|[Anti-Behavioral Analysis::Debugger Detection::Process Environment Block BeingDebugged (B0001.035)](../anti-behavioral-analysis/debugger-detection.md)|Check for PEB BeingDebugged flag (This capa rule had 6 matches) [[2]](#2) |
|[Anti-Behavioral Analysis::Debugger Detection::Timing/Delay Check GetTickCount (B0001.032)](../anti-behavioral-analysis/debugger-detection.md)|Check for time delay via GetTickCount (This capa rule had 1 match) [[2]](#2) |
|[Cryptography::Cryptographic Hash (C0029)](../micro-behaviors/cryptography/cryptographic-hash.md)|Hash data via WinCrypt (This capa rule had 1 match) [[2]](#2) |
|[Cryptography::Cryptographic Hash::SHA1 (C0029.002)](../micro-behaviors/cryptography/cryptographic-hash.md)|Hash data using SHA1 (This capa rule had 1 match) [[2]](#2) |
|[Cryptography::Encrypt Data (C0027)](../micro-behaviors/cryptography/encrypt-data.md)|Encrypt data using DPAPI (This capa rule had 6 matches) [[2]](#2) |
|[Data::Encode Data::XOR (C0026.002)](../micro-behaviors/data/encode-data.md)|Encode data using XOR (This capa rule had 1 match) [[2]](#2) |
|[Discovery::Code Discovery::Inspect Section Memory Permissions (B0046.002)](../discovery/code-discovery.md)|Inspect section memory permissions (This capa rule had 1 match) [[2]](#2) |
|[Discovery::Taskbar Discovery (B0043)](../discovery/taskbar-discovery.md)|Find taskbar (This capa rule had 1 match) [[2]](#2) |
|[Execution::Install Additional Program (B0023)](../execution/install-additional-program.md)|Contain an embedded PE file (This capa rule had 1 match) [[2]](#2) |
|[File System::Copy File (C0045)](../micro-behaviors/file-system/copy-file.md)|Copy file (This capa rule had 2 matches) [[2]](#2) |
|[File System::Create Directory (C0046)](../micro-behaviors/file-system/create-directory.md)|Create directory (This capa rule had 1 match) [[2]](#2) |
|[File System::Delete File (C0047)](../micro-behaviors/file-system/delete-file.md)|Delete file (This capa rule had 2 matches) [[2]](#2) |
|[File System::Get File Attributes (C0049)](../micro-behaviors/file-system/get-file-attributes.md)|Get file attributes (This capa rule had 2 matches) [[2]](#2) |
|[File System::Read File (C0051)](../micro-behaviors/file-system/read-file.md)|Read file on Windows (This capa rule had 3 matches) [[2]](#2) |
|[File System::Set File Attributes (C0050)](../micro-behaviors/file-system/set-file-attributes.md)|Set file attributes (This capa rule had 1 match) [[2]](#2) |
|[File System::Write File (C0052)](../micro-behaviors/file-system/writes-file.md)|Write file on Windows (This capa rule had 1 match) [[2]](#2) |
|[Memory::Allocate Memory (C0007)](../micro-behaviors/memory/allocate-memory.md)|Spawn thread to RWX shellcode (This capa rule had 1 match) [[2]](#2) |
|[Operating System::Registry::Delete Registry Key (C0036.002)](../micro-behaviors/operating-system/registry.md)|Delete registry key (This capa rule had 2 matches) [[2]](#2) |
|[Operating System::Registry::Query Registry Value (C0036.006)](../micro-behaviors/operating-system/registry.md)|Query or enumerate registry value (This capa rule had 9 matches) [[2]](#2) |
|[Operating System::Registry::Set Registry Key (C0036.001)](../micro-behaviors/operating-system/registry.md)|Set registry value (This capa rule had 4 matches) [[2]](#2) |
|[Process::Create Mutex (C0042)](../micro-behaviors/process/create-mutex.md)|Create mutex (This capa rule had 1 match) [[2]](#2) |
|[Process::Create Process (C0017)](../micro-behaviors/process/create-process.md)|Create process on Windows (This capa rule had 10 matches) [[2]](#2) |
|[Process::Create Process::Create Suspended Process (C0017.003)](../micro-behaviors/process/create-process.md)|Create process suspended (This capa rule had 10 matches) [[2]](#2) |
|[Process::Set Thread Local Storage Value (C0041)](../micro-behaviors/process/set-thread-local-storage-value.md)|Set thread local storage value (This capa rule had 1 match) [[2]](#2) |

## Indicators of Compromise

SHA256 Hashes
- 07b8f25e7b536f5b6f686c12d04edc37e11347c8acd5c53f98a174723078c365
- 65853e6a70b50166b2e2bd1e163d420d1184ff865183c5f68d8e8bb83eff3e6d

## References

<a name="1">[1]</a> https://web.archive.org/web/20161025013916/https://www.fireeye.com/blog/threat-research/2011/01/the-dead-giveaways-of-vm-aware-malware.html

<a name="2">[2]</a> capa v4.0, analyzed at MITRE on 10/12/2022


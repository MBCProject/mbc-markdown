<table>
<tr>
<td><b>ID</b></td>
<td><b>X0026</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2005</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b><a href="https://attack.mitre.org/software/S0012/">PoisonIvy</a></b></td>
</tr>
</table>


# Poison-Ivy

Remote Access Trojan (RAT).

## ATT&CK Techniques

See ATT&CK: [Poison Ivy - Techniques Used](https://attack.mitre.org/software/S0012/).

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Defense Evasion::Process Injection (E1055)](../defense-evasion/process-injection.md)|Code is injected into explorer.exe. [[2]](#2)|
|[Collection::Input Capture (E1056)](../collection/input-capture.md)|Poison Ivy can capture audio and video. [[2]](#2)|
|[Collection::Keylogging (F0002)](../collection/keylogging.md)|Poison Ivy can capture keystrokes. [[2]](#2)|
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|To start itself at system boot, Poison Ivy adds registry entries. [[4]](#4)|
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|After the Poison-Ivy server is running on the target machine, the attacker uses a Windows GUI client to control the target computer. [[1]](#1)|
|[Anti-Static Analysis::Executable Code Obfuscation::Stack Strings (B0032.017)](../anti-static-analysis/executable-code-obfuscation.md)|A Poison Ivy variant encrypts all its strings. [[3]](#3)|
|[Command and Control::Ingress Tool Transfer (E1105)](../command-and-control/ingress-tool-transfer.md)|The Poison Ivy implant is run on the target machine. [[2]](#2)|
|[Defense Evasion::Obfuscated Files or Information (E1027)](../defense-evasion/obfuscated-files-or-information.md)|The malware obfuscates files. [[2]](#2)|


## MBC Behaviors

|Name|Use|
|---|---|
|[Impact::Remote Access (B0022)](../impact/remote-access.md)|After the Poison-Ivy server is running on the target machine, the attacker uses a Windows GUI client to control the target computer. [[1]](#1)|
|[Micro-Behaviors::Cryptography::Encrypt Data::Camellia (C0027.003)](../micro-behaviors/cryptography/encrypt-data.md)|Poison Ivy's custom network protocol over TCP is encrypted using Camellia cipher with a 256-bit key. [[2]](#2)|
|[Micro-Behaviors::Process::Create Mutex (C0042)](../micro-behaviors/process/create-mutex.md)|Poison Ivy has a default process mutex, but can be altered at build time. [[3]](#3)|
|[Anti-Behavioral Analysis::Debugger Detection::Hardware Breakpoints (B0001.005)](../anti-behavioral-analysis/debugger-detection.md)|A Poison Ivy variant checks for breakpoints and exits immediately if found. [[3]](#3)|
|[Discovery::Analysis Tool Discovery (B0013)](../discovery/anlaysis-tool-discovery.md)|A Poison Ivy variant runs a threat to check if any analysis tools are running by creating specially named pipes that are created by various analysis tools. If one of the named pipes cannot be created, it means one of the analysis tools is running. [[3]](#3)|
|[Discovery::Analysis Tool Discovery::Known Windows Class Name (B0013.010)](../discovery/analysis-tool-discovery.md)|A Poison Ivy variant goes through all the running program windows to check if any Windows class name contains a special string to determine if an analysis tool is running. [[3]](#3)|
|[Micro-Behaviors::Process::Check Mutex (C0043)](../micro-behaviors/process/check-mutex.md)|A Poison Ivy variant checks if the wireshark-is-running{} named mutex object exists. [[3]](#3)|
|[Anti-Behavioral Analysis::Debugger Detection::IsDebuggerPresent (B0001.008)](../anti-behavioral-analysis/debugger-detection.md)|A Poison Ivy variant uses the IsDebuggerPresent API function call to check if the process is running in a debugger. [[3]](#3)|
|[Micro-Behaviors::Communication::Interprocess Communication::Write Pipe (C0003.004)](../micro-behaviors/communication/interprocess-communication.md)|Poison Ivy writes pipes. [[5]](#5)|
|[Micro-Behaviors::File System::Read File (C0051)](../micro-behaviors/file-system/read-file.md)|Poison Ivy reads files on Windows. [[5]](#5)|
|[Micro-Behaviors::File System::Write File (C0052)](../micro-behaviors/file-system/writes-file.md)|Poison Ivy writes files on Windows. [[5]](#5)|
|[Micro-Behaviors::Operating System::Registry::Query Registry Value (C0036.006)](../micro-behaviors/operating-system/registry.md)|Poison Ivy queries or enumerates registry values. [[5]](#5)|


## Indicators of Compromise

SHA256 Hashes
- 84d90250568f26328394ac2941fe7be266d43b71309caf40eb8863b38a39a506
- 4d43c64d776a52ac5a0831aa879305c0eabb452ac5131e1b381598ad7e83cc77

## References

<a name="1">[1]</a> https://www.cyber.nj.gov/threat-center/threat-profiles/trojan-variants/poison-ivy

<a name="2">[2]</a> https://www.mandiant.com/sites/default/files/2021-09/rpt-poison-ivy.pdf

<a name="3">[3]</a> https://www.fortinet.com/blog/threat-research/deep-analysis-of-new-poison-ivy-variant

<a name="4">[4]</a> https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/poisonivy

<a name="5">[5]</a> capa v4.0, analyzed at MITRE on 10/12/2022


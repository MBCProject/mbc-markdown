|||
|---|---|
|**ID**|**X0014**|
|**Aliases**|None|
|**Platforms**|Windows|
|**Year**|2005|
|**Associated ATT&CK Software**|[PoisonIvy](https://attack.mitre.org/software/S0012/)|


Poison-Ivy
==========
Remote Access Trojan (RAT).

ATT&CK Techniques
-----------------
See ATT&CK: [Poison Ivy - Techniques Used](https://attack.mitre.org/software/S0012/).

Behaviors
---------
|Name|Use|
|---|---|
|[Impact::Remote Access (B0022)](../impact/remote-access.md)|After the Poison-Ivy server is running on the target machine, the attacker uses a Windows GUI client to control the target computer [[1]](#1)|
|[Defense Evasion::Process Injection (E1055)](../defense-evasion/process-inject.md)|Code is injected into explorer.exe [[2]](#2)|
|[Micro-objective::Cryptography::Encrypt Data::Camellia (C0027.003)](../micro-behaviors/cryptography/encrypt.md)|Poison Ivy's custom network protocol over TCP is encrypted using Camellia cipher with a 256-bit key  [[2]](#2)|
|[Collection::Input Capture (E1056)](../collection/input-capture.md)|Can capture audio and video  [[2]](#2)|
|[Collection::Keylogging (F0002)](../collection/keylogging.md)|Can capture keystrokes  [[2]](#2)|
|[Micro-objective::Process::Create Mutex (C0042)](../micro-behaviors/process/create-mutex.md)|Poison Ivy has a default process mutex, but can be altered at build time [2] [[3]](#3)|
|[Anti-Behavioral Analysis::Debugger Detection::Hardware Breakpoints (B0001.005)](../anti-behavioral-analysis/detect-debugger.md)|Poison Ivy Variant checks for breakpoints and exits immediately if found [[3]](#3)|
|[Discovery::Analysis Tool Discovery (B0013)](../discovery/analysis-tool-discover.md)|Poison Ivy Variant runs a threat to check if any analysis tools are running by creating specially named pipes that are created by various analysis tools. If one of the named pipes cannot be created, it means one fo the analysis tools is running.  [[3]](#3)|
|[Discovery::Analysis Tool Discovery::Known Window Class Name (B0013.010)](../discovery/analysis-tool-discover.md)|Poison Ivy variant goes through all the running program windows to check  if any windows class name contains a special string to determine if an analysis tool is running [[3]](#3)|
|[Process::Micro-objective::Check Mutex (C0043)](../micro-behaviors/process/check-mutex.md)|Poison Ivy variant checks if the wireshark-is-running{} named mutex object exists [[3]](#3)|
|[Anti-Behavioral Analysis::Debugger Detection::IsDebuggerPresent (B0001.008)](../anti-behavioral-analysis/detect-debugger.md)|Poison Ivy variant uses the IsDebuggerPresent API function call to check if the process is running in a debugger [[3]](#3)|
|[Persistence::Registy Run Keys / Startup folder (F0012)](../persistence/registry-run-startup.md)|To start itself at system boot, Poison Ivy adds registry entries [[4]](#4)|
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-line.md)|After the Poison-Ivy server is running on the target machine, the attacker uses a Windows GUI client to control the target computer [[1]](#1)|
|[Anti-Static Analysis::Obfuscated Files or Information::Encryption of Data (E1027.m07)](../anti-static-analysis/exe-code-obfuscate.md)|Poison Ivy variant encrypts all its strings [[3]](#3)|

References
----------
<a name="1">[1]</a> https://www.cyber.nj.gov/threat-center/threat-profiles/trojan-variants/poison-ivy

<a name="2">[2]</a> https://www.mandiant.com/sites/default/files/2021-09/rpt-poison-ivy.pdf

<a name="3">[3]</a> https://www.fortinet.com/blog/threat-research/deep-analysis-of-new-poison-ivy-variant

<a name="4">[4]</a> https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/poisonivy
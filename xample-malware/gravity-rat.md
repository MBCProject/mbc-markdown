<table>
<tr>
<td><b>ID</b></td>
<td><b>X0016</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2018</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b><a href="https://attack.mitre.org/software/S0237/">GravityRAT</a></b></td>
</tr>
</table>


# GravityRAT

GravityRAT evades detection by checking current CPU temperature.


## ATT&CK Techniques

|Name|Use|
|---|---|
|[Discovery::Account Discovery (T1087)](https://attack.mitre.org/techniques/T1087)|GravityRAT gets session user name. [[4]](#4)|

See ATT&CK: [GravityRAT - Techniques Used](https://attack.mitre.org/software/S0237/).

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Defense Evasion::Hijack Execution Flow::Abuse Windows Function Calls (F0015.006)](../defense-evasion/hijack-execution-flow.md)|GravityRAT abuses Microsoft's Dynamic Data Exchange (DDE) protocol. [[2]](#2)|
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|GravityRAT enumerates files on Windows. [[4]](#4)|


## MBC Behaviors

|Name|Use|
|---|---|
|[Anti-Behavioral Analysis::Virtual Machine Detection (B0009)](../anti-behavioral-analysis/virtual-machine-detection.md)|The malware checks the system temperature by recording thermal readings for detecting VMs. Heat levels indicate whether the system is a VM. [[1]](#1)|
|[Anti-Behavioral Analysis::Virtual Machine Detection::Unique Hardware/Firmware Check - BIOS (B0009.024)](../anti-behavioral-analysis/virtual-machine-detection.md)|The malware creates a WMI request to identify the BIOS version. [[1]](#1)|
|[Micro-Objective::Cryptography::Encrypt Data::AES (C0027.001)](../micro-behaviors/cryptography/encrypt-data.md)|GravityRAT v3 supports AES file encryption. [[2]](#2)|
|[Anti-Behavioral Analysis::Virtual Machine Detection::Unique Hardware/Firmware Check (B0009.023)](../anti-behavioral-analysis/virtual-machine-detection.md)|The malware checks if the manufacturer field in the Win32_Computer entry (in WMI) contains "Virtual", "Vmware", or "Virtualbox." [[2]](#2)|
|[Anti-Behavioral Analysis::Virtual Machine Detection::Modern Specs Check - Processor count (B0009.018)](../anti-behavioral-analysis/virtual-machine-detection.md)|GravityRAT determines the machine to be a VM if the core count is 1. [[2]](#2)|
|[Anti-Behavioral Analysis::Virtual Machine Detection::Unique Hardware/Firmware Check - MAC Address (B0009.028)](../anti-behavioral-analysis/virtual-machine-detection.md)|GravityRAT checks if the MAC address starts with a well-known hexadecimal number used by various VM developer. [[2]](#2)|
|[Command And Control::C2 Communication::Receive Data (B0030.002)](../command-and-control/c2-communication.md)|GravityRAT receives data. [[4]](#4)|
|[Micro-Behaviors::File System::Create Directory (C0046)](../micro-behaviors/file-system/create-directory.md)|GravityRAT creates directories. [[4]](#4)|
|[Micro-Behaviors::File System::Delete File (C0047)](../micro-behaviors/file-system/delete-file.md)|GravityRAT deletes files. [[4]](#4)|
|[Micro-Behaviors::File System::Read File (C0051)](../micro-behaviors/file-system/read-file.md)|GravityRAT reads files on Windows. [[4]](#4)|
|[Micro-Behaviors::File System::Write File (C0052)](../micro-behaviors/file-system/writes-file.md)|GravityRAT writes files on Windows. [[4]](#4)|
|[Micro-Behaviors::Process::Suspend Thread (C0055)](../micro-behaviors/process/suspend-thread.md)|GravityRAT suspends threads. [[4]](#4)|
|[Micro-Behaviors::Process::Terminate Process (C0018)](../micro-behaviors/process/terminate-process.md)|GravityRAT terminates processes. [[4]](#4)|


## Indicators of Compromise

SHA256 Hashes
- c39270febb9097def21777c994d10738ba2a915c88f516fb1e896e5d7240cc0d
- 71264d9c67800d3bedc6facb6915e855f7531c12445af58f47167e81c735c892
- 99dd67915566c0951b78d323bb066eb5b130cc7ebd6355ec0338469876503f90

## References

<a name="1">[1]</a> https://www.hackread.com/gravityrat-malware-evades-detection-targets-india/

<a name="2">[2]</a> https://blog.talosintelligence.com/2018/04/gravityrat-two-year-evolution-of-apt.html

<a name="3">[3]</a> https://securelist.com/gravityrat-the-spy-returns/99097/

<a name="4">[4]</a> capa v4.0, analyzed at MITRE on 10/12/2022



<table>
<tr>
<td><b>ID</b></td>
<td><b>X0031</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2015</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b>None</b></td>
</tr>
</table>


# Rombertik

This family of malware steals data the user enters into a browser and uses a variety of behaviors to hinder analysis. [[1]](#1)


## ATT&CK Techniques

|Name|Use|
|---|---|
|[Initial Access::Phishing::Spearphishing Attachment (T1566.001)](https://attack.mitre.org/techniques/T1566/001/)|The malware is sent out to victims via an attachment [[1]](#1)|
|[Persistence::Boot or Logon Autostart Execution (T1547)](https://attack.mitre.org/techniques/T1547/)|The malware starts everytime a user logs in [[1]](#1)|
|[Defense Evasion::Deobfuscate/Decode Files or Information (T1140)](https://attack.mitre.org/techniques/T1140/)|The malware will unpack its code in memory [[1]](#1)|
|[Impact::Disk Wipe (T1561)](https://attack.mitre.org/techniques/T1561/)|If a specific anti-analysis check fails, the malware will overwrite the Master Boot Record or the User's home folder [[1]](#1)|
|[Command and Control::Data Encoding::Standard Encoding (T1132.001)](https://attack.mitre.org/techniques/T1132/001/)|The malware transmits Base64 encoded data to C2 [[1]](#1)|
|[Command and Control::Application Layer Protocol::Web Protocols (T1071.001)](https://attack.mitre.org/techniques/T1071/001/)|The malware transmits data over HTTP [[1]](#1)|

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Execution::User Execution (E1204)](../execution/user-execution.md)|The malware relies on a victim to execute itself [[1]](#1)|
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|The malware will proceed to install itself in order to ensure persistence across system reboots before continuing on to execute the payload. To install itself, Rombertik first creates a VBS script named “fgf.vbs”, which is used to kick off 
|[Collection::Input Capture (E1056)](../collection/input-capture.md)|The malware injects itself into a browser and captures user input data [[1]](#1)|
|[Impact::Data Destruction (E1485)](../impact/data-destruction.md)|If a specific anti-analysis check fails, the malware will overwrite the Master Boot Record or the User's home folder [[1]](#1)|


## MBC Behaviors

|Name|Use|
|---|---|
|[Anti-Static Analysis::Executable Code Obfuscation::Code Insertion (B0032.002)](../anti-static-analysis/executable-code-obfuscation.md)|Most of the malware file consists of unnecessary code or unnecessary data [[1]](#1)|
|[Anti-Behavior Analysis::Dynamic Analysis Evasion::Data Flood (B0003.002)](../anti-behavioral-analysis/dynamic-analysis-evasion.md)|The malware stalls by writing a byte of random data to memory 960 million times which complicates analysis. It also calls specific Windows API functions [[1]](#1)|
|[Anti-Behavioral Analysis::Sandbox Detection::Test API Routines (B0007.010)](../anti-behavioral-analysis/virtual-machine-detection.md)|The malware check for sandboxes that suppress errors returned from API routine calls the using ZwGetWriteWatch routine. [[1]](#1)|
|[Anti-Behavioral Analysis::Debugger Detection::OutputDebugString (B0001.016)](../anti-behavioral-analysis/virtual-machine-detection.md)|The malware calls the Windows API OutputDebugString function 335,000 times [[1]](#1)|
|[Anti-Behavior Analysis::Debugger Detection::Check Processes (B0001.038)](../anti-behavioral-analysis/virtual-machine-detection.md)|an anti-analysis function within the packer is called to check the username and filename of the executing process for strings like “malwar”, “sampl”, “viru”, and “sandb”. [[1]](#1)|Rombertik every time the user logs in, and places the script into the user’s Startup folder. [[1]](#1)|
|[Anti-Behavioral Anlaysis::Dynamic Analysis Evasion::Code Integrity Check (B0003.011)](../anti-behavioral-analysis/dynamic-analysis-evasion.md)|The function computes a 32-bit hash of a resource in memory, and compares it to the PE Compile Timestamp of the unpacked sample. If the resource or compile time has been altered, the malware acts destructively [[1]](#1)|
|[Command and Control::C2 Communication::Send Data (B0030.001)](../command-and-control/domain-name-generation.md)|The malware sends data to the C2 [[1]](#1)|

## Indicators of Compromise

SHA256 Hashes
- 0d11a13f54d6003a51b77df355c6aa9b1d9867a5af7661745882b61d9b75bccf

Command-and-Control Servers
- www.centozos[.]org[.]in

## References

<a name="1">[1]</a> https://blogs.cisco.com/security/talos/rombertik

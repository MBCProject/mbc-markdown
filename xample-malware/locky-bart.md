<table>
<tr>
<td><b>ID</b></td>
<td><b>X0021</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2017</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b>None</b></td>
</tr>
</table>


# Locky Bart

Locky Bart is ransomware.  [[1]](#1)

## ATT&CK Techniques

|Name|Use|
|---|---|
|[Discovery::Process Discovery (T1057)](https://attack.mitre.org/techniques/T1057/)|Gathers information from the victim's machine to create an encryption key. [[1]](#1) |
|[Discovery::System Time Discovery (T1057)](https://attack.mitre.org/techniques/T1124/)|Gathers information from the victim's machine to create an encryption key. [[1]](#1) |
|[Discovery::System Location Discovery::System Language Discovery (T1614.001)](https://attack.mitre.org/techniques/T1614/001)|Identify system language via API (This capa rule had 1 match) [[2]](#2) |
|[Execution::Shared Modules (T1129)](https://attack.mitre.org/techniques/T1129)|Parse PE header (This capa rule had 2 matches) [[2]](#2) |

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Impact::Data Encrypted for Impact (E1486)](../impact/data-encrypted-for-impact.md)|Encrypts files for ransom without any connection to the Internet [[1]](#1) |
|[Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm (E1027.m02)](../defense-evasion/obfuscated-files-or-information.md)|Encode data using XOR (This capa rule had 4 matches) [[2]](#2) |
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|Get file size (This capa rule had 1 match) [[2]](#2) |

## MBC Behaviors

|Name|Use|
|---|---|
|[Anti-Static Analysis::Executable Code Virtualization (B0008)](../anti-static-analysis/executable-code-virtualization.md)|Code virtualization is added to the Locky Bart binary using WPProtect. [[1]](#1) |
|[Cryptography::Encrypt Data::RC4 (C0027.009)](../micro-behaviors/cryptography/encrypt-data.md)|Encrypt data using RC4 PRGA (This capa rule had 1 match) [[2]](#2) |
|[Cryptography::Encryption Key (C0028)](../micro-behaviors/cryptography/encryption-key.md)|Create new key via CryptAcquireContext (This capa rule had 1 match) [[2]](#2) |
|[Cryptography::Generate Pseudo-random Sequence::Use API (C0021.003)](../micro-behaviors/cryptography/generate-pseudorandom-sequence.md)|Generate random numbers via WinAPI (This capa rule had 1 match) [[2]](#2) |
|[Data::Check String (C0019)](../micro-behaviors/data/check-string.md)|Reference Base64 string (This capa rule had 1 match) [[2]](#2) |
|[Data::Checksum::CRC32 (C0032.001)](../micro-behaviors/data/checksum.md)|Hash data with CRC32 (This capa rule had 2 matches) [[2]](#2) |
|[Data::Encode Data::XOR (C0026.002)](../micro-behaviors/data/encode-data.md)|Encode data using XOR (This capa rule had 4 matches) [[2]](#2) |
|[Discovery::Code Discovery::Enumerate PE Sections (B0046.001)](../discovery/code-discovery.md)|Enumerate PE sections (This capa rule had 2 matches) [[2]](#2) |
|[File System::Read File (C0051)](../micro-behaviors/file-system/read-file.md)|Read file on Windows (This capa rule had 2 matches) [[2]](#2) |
|[File System::Write File (C0052)](../micro-behaviors/file-system/writes-file.md)|Write file on Windows (This capa rule had 3 matches) [[2]](#2) |
|[Operating System::Registry::Set Registry Key (C0036.001)](../micro-behaviors/operating-system/registry.md)|Set registry value (This capa rule had 1 match) [[2]](#2) |
|[Process::Create Thread (C0038)](../micro-behaviors/process/create-thread.md)|Create thread (This capa rule had 1 match) [[2]](#2) |

## Indicators of Compromise

SHA256 Hashes
- c285e376201e2941154ec1a9acd8658cd5e0ea975c694a3fe3e9a9897efc2680

## References

<a name="1">[1]</a> https://blog.malwarebytes.com/threat-analysis/2017/01/locky-bart-ransomware-and-backend-server-analysis/

<a name="2">[2]</a> capa v4.0, analyzed at MITRE on 10/12/2022


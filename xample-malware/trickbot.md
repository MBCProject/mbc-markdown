|||
|---|---|
|**ID**|**X0025**|
|**Aliases**|None|
|**Platforms**|Windows|
|**Year**|2016|
|**Associated ATT&CK Software**|[TrickBot](https://attack.mitre.org/software/S0266/)|


TrickBot
========
Trojan spyware program that has mainly been used for targeting banking sites. TrickBot is written in the C++ programming language.


ATT&CK Techniques
-----------------
|Name|Use|
|---|---|
|[Account Discovery](https://attack.mitre.org/techniques/T1087/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Non-Standard Port](https://attack.mitre.org/techniques/T1571/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Credentials from Password Stores::Credentials from Web Browsers](https://attack.mitre.org/techniques/T1555/003/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Unsecured Credentials::Credentials In Files](https://attack.mitre.org/techniques/T1552/001/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Unsecured Credentials::Credentials in Registry](https://attack.mitre.org/techniques/T1552/002/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Encrypted Channel](https://attack.mitre.org/techniques/T1573/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Data from Local System](https://attack.mitre.org/techniques/T1005/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Disable or Evade Security Tools](../defense-evasion/disable-or-evade-security-tools.md)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Domain Trust Discovery](https://attack.mitre.org/techniques/T1482/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Email Collection](https://attack.mitre.org/techniques/T1114/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Native API](https://attack.mitre.org/techniques/T1106/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[File and Directory Discovery](https://attack.mitre.org/techniques/T1083/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Hooking](../credential-access/hooking.md)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Man in the Browser](https://attack.mitre.org/techniques/T1185/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Modify Registry](../defense-evasion/modify-registry.md)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Obfuscated Files or Information](../defense-evasion/obfuscated-files-or-information.md)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Process Injection](../defense-evasion/process-injection.md)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Registry Run Keys / Startup Folder](../persistence/registry-run-keys-startup-folder.md)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Remote File Copy](../command-and-control/ingress-tool-transfer.md)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Scheduled Task/Job](https://attack.mitre.org/techniques/T1053/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Executable Code Obfuscation](../anti-static-analysis/executable-code-obfuscation.md)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Send Email](../execution/send-email.md)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Application Layer Protocol](https://attack.mitre.org/techniques/T1071/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[System Information Discovery](../discovery/system-information-discovery.md)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[System Service Discovery](https://attack.mitre.org/techniques/T1016/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[Non-Standard Port](https://attack.mitre.org/techniques/T1571/)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|
|[User Interaction](../execution/user-execution.md)|See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/)|

Behaviors
---------
|Name|Use|
|---|---|
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|Collects local files with specified file extensions and information from the victim's machine [[1]](#1)|
|[Anti-Static Analysis::Software Packing (F0001)](../anti-static-analysis/software-packing.md)|Has a custom packer to obfuscate itself  [[1]](#1)|
|[Defense Evasion::Process Injection (E1055)](../defense-evasion/process-injection.md)|Injects itself into svchost.exe  [[2]](#2)|
|[Persistence::Registy Run Keys / Startup folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|has an auto-start service that allows it to run whenever the machine boots  [[3]](#3)|
|[Defense Evasion::Indicator Blocking (F0006)](../defense-evasion/indicator-blocking.md)|Terminates the following anti-malware services: Window Defender, MBamService (Malwarebytes), SAVService (Sophos AV) [[3]](#3)|
|[Exfiltration::Archive Collected Data::Encryption (E1560.m02)](../exfiltration/archive-collected-data.md)|Uses a custom crypter leveraging Microsoft's CryptoAPI to encrypt C2 traffic. C2 update responses seem to have been digitally signed using bcrypt  [[4]](#4)|
|[Execution::Remote Commands (B0011)](../execution/remote-commands.md)|Receives various commands from c2 server.  [[2]](#2)|
|[Micro-Objective::Cryptography::Encrypt Data:AES (C0027.001)](../micro-behaviors/cryptography/encrypt-data.md)|Uses an AES CBC (256 bits) encryption algorithm for its loader and configuration files  [[1]](#1)|
|[Defense Evasion::Bootkit (F0013)](../defense-evasion/bootkit.md)|Can implement malicious code into firmware, allowing read, write, and/or erasure of the UEFI/BIOS firmware  [[5]](#5)|
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|Can collect information about the compter, resources, services, installed programs, firmware, and operating system version  [[1]](#1)|
|[Anti-Behavioral Analysis::Evade Dynamic Analysis (B0003.012)](../anti-behavioral-analysis/dynamic-analysis-evasion.md)|Uses numerous printf loops to delay the execution process and overload the sandbox with junk data (API Hammering) [[6]](#6)|


Indicators of Compromise
------------------------
MD5 Hashes
- 28661ea73413822c3b5b7de1bef0b246
- 218613f0f1d2780f08e754be9e6f8c64
- 135e4fa98e2ba7086133690dbd631785
- 719578c91b4985d1f955f6adb688314f
- 132c4338cdc46a0a286abf574d68e2e0
- e8e7b0a8f274cad7bdaedd5a91b5164d

Yara Rules
- rule MALW_trickbot_bankBot : Trojan { meta: author = "Marc Salinas @Bondey_m" description = "Detects Trickbot Banking Trojan" strings: $str_trick_01 = "moduleconfig" $str_trick_02 = "Start" $str_trick_03 = "Control" $str_trick_04 = "FreeBuffer" $str_trick_05 = "Release" condition: all of ($str_trick_*) }
- rule MALW_systeminfo_trickbot_module : Trojan { meta: author = "Marc Salinas @Bondey_m" description = "Detects systeminfo module from Trickbot Trojan" strings: $str_systeminf_01 = "" $str_systeminf_02 = "" $str_systeminf_03 = "" $str_systeminf_04 = "GetSystemInfo.pdb" $str_systeminf_05 = "" $str_systeminf_06 = "" condition: all of ($str_ systeminf_*) }
- rule MALW_dllinject_trickbot_module : Trojan { meta: author = "Marc Salinas @Bondey_m" description = " Detects dllinject module from Trickbot Trojan" strings: $str_dllinj_01 = "user_pref(" $str_dllinj_02 = "" $str_dllinj_03 = "" $str_dllinj_04 = "" condition: all of ($str_ dllinj_*) }
- rule MALW_mailsercher_trickbot_module : Trojan { meta: author = "Marc Salinas @Bondey_m" description = " Detects mailsearcher module from Trickbot Trojan" strings: $str_mails_01 = "mailsearcher" $str_mails_02 = "handler" $str_mails_03 = "conf" $str_mails_04 = "ctl" $str_mails_05 = "SetConf" $str_mails_06 = "file" $str_mails_07 = "needinfo" $str_mails_08 = "mailconf" condition: all of ($str_mails_*) }

References
----------

<a name="1">[1]</a> https://www.securityartwork.es/wp-content/uploads/2017/07/Trickbot-report-S2-Grupo.pdf

<a name="2">[2]</a> https://www.cybereason.com/blog/research/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware

<a name="3">[3]</a> https://www.trendmicro.com/en_us/research/18/k/trickbot-shows-off-new-trick-password-grabber-module.html

<a name="4">[4]</a> https://www.bitdefender.com/blog/labs/trickbot-is-dead-long-live-trickbot/

<a name="5">[5]</a> https://eclypsium.com/wp-content/uploads/2020/12/TrickBot-Now-Offers-TrickBoot-Persist-Brick-Profit.pdf

<a name="6">[6]</a> https://www.joesecurity.org/blog/498839998833561473
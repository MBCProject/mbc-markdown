<table>
<tr>
<td><b>ID</b></td>
<td><b>X0025</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2016</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b><a href="https://attack.mitre.org/software/S0266/">TrickBot</a></b></td>
</tr>
</table>


# TrickBot

Trojan spyware program that has mainly been used for targeting banking sites. TrickBot is written in the C++ programming language.


## ATT&CK Techniques

|Name|Use|
|---|---|
|[Execution::Shared Modules (T1129)](https://attack.mitre.org/techniques/T1129)|Parse PE header (This capa rule had 2 matches) [[7]](#7) |

See ATT&CK: [TrickBot - Techniques Used](https://attack.mitre.org/software/S0266/).

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|Collects local files with specified file extensions and information from the victim's machine [[1]](#1) |
|[Anti-Static Analysis::Software Packing (F0001)](../anti-static-analysis/software-packing.md)|Has a custom packer to obfuscate itself  [[1]](#1) |
|[Defense Evasion::Process Injection (E1055)](../defense-evasion/process-injection.md)|Injects itself into svchost.exe  [[2]](#2) |
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|Has an auto-start service that allows it to run whenever the machine boots  [[3]](#3) |
|[Defense Evasion::Indicator Blocking (F0006)](../defense-evasion/indicator-blocking.md)|Terminates the following anti-malware services: Window Defender, MBamService (Malwarebytes), SAVService (Sophos AV) [[3]](#3) |
|[Exfiltration::Archive Collected Data::Encryption (E1560.m02)](../exfiltration/archive-collected-data.md)|Uses a custom crypter leveraging Microsoft's CryptoAPI to encrypt C2 traffic. C2 update responses seem to have been digitally signed using bcrypt  [[4]](#4) |
|[Defense Evasion::Bootkit (F0013)](../defense-evasion/bootkit.md)|Can implement malicious code into firmware, allowing read, write, and/or erasure of the UEFI/BIOS firmware  [[5]](#5) |
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|Can collect information about the compter, resources, services, installed programs, firmware, and operating system version [[1]](#1) |
|[Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm (E1027.m02)](../defense-evasion/obfuscated-files-or-information.md)|Encode data using XOR (This capa rule had 2 matches) [[7]](#7) |
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|Accept command line arguments (This capa rule had 1 match) [[7]](#7) |

## MBC Behaviors

|Name|Use|
|---|---|
|[Execution::Remote Commands (B0011)](../execution/remote-commands.md)|Receives various commands from c2 server.  [[2]](#2) |
|[Micro-Objective::Cryptography::Encrypt Data::AES (C0027.001)](../micro-behaviors/cryptography/encrypt-data.md)|Uses an AES CBC (256 bits) encryption algorithm for its loader and configuration files  [[1]](#1) |
|[Anti-Behavioral Analysis::Dynamic Analysis Evasion (B0003.012)](../anti-behavioral-analysis/dynamic-analysis-evasion.md)|Uses numerous printf loops to delay the execution process and overload the sandbox with junk data (API Hammering) [[6]](#6) |
|[Data::Encode Data::XOR (C0026.002)](../micro-behaviors/data/encode-data.md)|Encode data using XOR (This capa rule had 2 matches) [[7]](#7) |
|[Discovery::Code Discovery::Inspect Section Memory Permissions (B0046.002)](../discovery/code-discovery.md)|Inspect section memory permissions (This capa rule had 2 matches) [[7]](#7) |
|[Memory::Allocate Memory (C0007)](../micro-behaviors/memory/allocate-memory.md)|Allocate RWX memory (This capa rule had 7 matches) [[7]](#7) |
|[Process::Create Process (C0017)](../micro-behaviors/process/create-process.md)|Create process on Windows (This capa rule had 1 match) [[7]](#7) |
|[Process::Create Process::Create Suspended Process (C0017.003)](../micro-behaviors/process/create-process.md)|Create process suspended (This capa rule had 1 match) [[7]](#7) |
|[Process::Terminate Process (C0018)](../micro-behaviors/process/terminate-process.md)|Terminate process (This capa rule had 1 match) [[7]](#7) |
|[Impact::Spamming (B0039)](../impact/spamming.md)|TrickBot was observed infecting computers to steal email passwords and address books to spread malicious emails [[8]](#8)|

## Indicators of Compromise

SHA256 Hashes
- a162bb9219a09b302b90bc6f908e117e3fb2c722560336d378fd76a8f22f78f8
MD5 Hashes
- 28661ea73413822c3b5b7de1bef0b246
- 218613f0f1d2780f08e754be9e6f8c64
- 135e4fa98e2ba7086133690dbd631785
- 719578c91b4985d1f955f6adb688314f
- 132c4338cdc46a0a286abf574d68e2e0
- e8e7b0a8f274cad7bdaedd5a91b5164d
Yara Rules
- rule MALW_trickbot_bankBot : Trojan { meta: author = "Marc Salinas @Bondey_m" description = "Detects Trickbot Banking Trojan" strings: $str_trick_01 = "moduleconfig" $str_trick_02 = "Start" $str_trick_03 = "Control" $str_trick_04 = "FreeBuffer" $str_trick_05 = "Release" condition: all of ($str_trick_*) }
- rule MALW_systeminfo_trickbot_module : Trojan { meta: author = "Marc Salinas @Bondey_m" description = "Detects systeminfo module from Trickbot Trojan" strings: $str_systeminf_01 = "" $str_systeminf_02 = "" $str_systeminf_03 = "" $str_systeminf_04 = "GetSystemInfo.pdb" $str_systeminf_05 = "" $str_systeminf_06 = "" condition: all of ($str_ systeminf_*) }
- rule MALW_dllinject_trickbot_module : Trojan { meta: author = "Marc Salinas @Bondey_m" description = " Detects dllinject module from Trickbot Trojan" strings: $str_dllinj_01 = "user_pref(" $str_dllinj_02 = "" $str_dllinj_03 = "" $str_dllinj_04 = "" condition: all of ($str_ dllinj_*) }
- rule MALW_mailsercher_trickbot_module : Trojan { meta: author = "Marc Salinas @Bondey_m" description = " Detects mailsearcher module from Trickbot Trojan" strings: $str_mails_01 = "mailsearcher" $str_mails_02 = "handler" $str_mails_03 = "conf" $str_mails_04 = "ctl" $str_mails_05 = "SetConf" $str_mails_06 = "file" $str_mails_07 = "needinfo" $str_mails_08 = "mailconf" condition: all of ($str_mails_*) }

## References

<a name="1">[1]</a> https://www.securityartwork.es/wp-content/uploads/2017/07/Trickbot-report-S2-Grupo.pdf

<a name="2">[2]</a> https://www.cybereason.com/blog/research/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware

<a name="3">[3]</a> https://www.trendmicro.com/en_us/research/18/k/trickbot-shows-off-new-trick-password-grabber-module.html

<a name="4">[4]</a> https://www.bitdefender.com/blog/labs/trickbot-is-dead-long-live-trickbot/

<a name="5">[5]</a> https://eclypsium.com/wp-content/uploads/2020/12/TrickBot-Now-Offers-TrickBoot-Persist-Brick-Profit.pdf

<a name="6">[6]</a> https://www.joesecurity.org/blog/498839998833561473

<a name="7">[7]</a> capa v4.0, analyzed at MITRE on 10/12/2022

<a name="8">[8]</a> https://techcrunch.com/2019/07/12/trickbot-spam-millions-emails/

<table>
<tr>
<td><b>ID</b></td>
<td><b>X0008</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>Delf, Emerleox, Logsnif, Graybird, Pcclient</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2013</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b>None</b></td>
</tr>
</table>


# Hupigon

A family of backdoors.


## ATT&CK Techniques

|Name|Use|
|---|---|
|[Collection::Clipboard Data (T1115)](https://attack.mitre.org/techniques/T1115)|Read clipboard data (This capa rule had 5 matches) [[3]](#3) |
|[Defense Evasion::File and Directory Permissions Modification (T1222)](https://attack.mitre.org/techniques/T1222)|Set file attributes (This capa rule had 1 match) [[3]](#3) |
|[Defense Evasion::Hide Artifacts::Hidden Window (T1564.003)](https://attack.mitre.org/techniques/T1564/003)|Hide graphical window (This capa rule had 5 matches) [[3]](#3) |
|[Discovery::Application Window Discovery (T1010)](https://attack.mitre.org/techniques/T1010)|Enumerate gui resources (This capa rule had 2 matches) [[3]](#3) |
|[Discovery::System Location Discovery (T1614)](https://attack.mitre.org/techniques/T1614)|Get geographical location (This capa rule had 5 matches) [[3]](#3) |
|[Discovery::System Location Discovery::System Language Discovery (T1614.001)](https://attack.mitre.org/techniques/T1614/001)|Get keyboard layout (This capa rule had 2 matches) [[3]](#3) |
|[Discovery::System Network Configuration Discovery (T1016)](https://attack.mitre.org/techniques/T1016)|Get local IPv4 addresses (This capa rule had 2 matches) [[3]](#3) |
|[Discovery::System Service Discovery (T1007)](https://attack.mitre.org/techniques/T1007)|Query service status (This capa rule had 3 matches) [[3]](#3) |
|[Execution::Shared Modules (T1129)](https://attack.mitre.org/techniques/T1129)|Link many functions at runtime (This capa rule had 4 matches) [[3]](#3) |
|[Execution::System Services::Service Execution (T1569.002)](https://attack.mitre.org/techniques/T1569/002)|Create service (This capa rule had 2 matches) [[3]](#3) |
|[Impact::Service Stop (T1489)](https://attack.mitre.org/techniques/T1489)|Stop service (This capa rule had 1 match) [[3]](#3) |
|[Impact::System Shutdown/Reboot (T1529)](https://attack.mitre.org/techniques/T1529)|Shutdown system (This capa rule had 1 match) [[3]](#3) |
|[Persistence::Create or Modify System Process::Windows Service (T1543.003)](https://attack.mitre.org/techniques/T1543/003)|Start service (This capa rule had 1 match) [[3]](#3) |
|[Privilege Escalation::Access Token Manipulation (T1134)](https://attack.mitre.org/techniques/T1134)|Acquire debug privileges (This capa rule had 2 matches) [[3]](#3) |

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Defense Evasion::Process Injection (E1055)](../defense-evasion/process-injection.md)|The malware injects itself into processes such as cmd.exe, notepad.exe [[2]](#2) |
|[Defense Evasion::Rootkit (E1014)](../defense-evasion/rootkit.md)| Certain variants of the malware may have rootkit functionality [[2]](#2) |
|[Collection::Keylogging (F0002)](../collection/keylogging.md)|Certain variants of the malware may have keylogging functionality [[2]](#2) |
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|Hupigon drops the file "Systen.dll" and adds the registry entry: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\BITS DllName = "%System%\Systen.dll". [[1]](#1) |
|[Defense Evasion::Modify Registry (E1112)](../defense-evasion/modify-registry.md)|The malware adds many entries to the registry [[1]](#1) |
|[Collection::Keylogging::Polling (F0002.002)](../collection/keylogging.md)|Log keystrokes via polling (This capa rule had 6 matches) [[3]](#3) |
|[Collection::Screen Capture::WinAPI (E1113.m01)](../collection/screen-capture.md)|Capture screenshot (This capa rule had 2 matches) [[3]](#3) |
|[Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm (E1027.m02)](../defense-evasion/obfuscated-files-or-information.md)|Encode data using XOR (This capa rule had 8 matches) [[3]](#3) |
|[Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm (E1027.m05)](../defense-evasion/obfuscated-files-or-information.md)|Encrypt data using DES (This capa rule had 1 match) [[3]](#3) |
|[Discovery::Application Window Discovery::Window Text (E1010.m01)](../discovery/application-window-discovery.md)|Get graphical window text (This capa rule had 1 match) [[3]](#3) |
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|Enumerate files recursively (This capa rule had 1 match) [[3]](#3) |
|[Discovery::File and Directory Discovery::Log File (E1083.m01)](../discovery/file-and-directory-discovery.md)|Access the Windows event log (This capa rule had 1 match) [[3]](#3) |
|[Impact::Clipboard Modification (E1510)](../impact/clipboard-modification.md)|Replace clipboard data (This capa rule had 1 match) [[3]](#3) |
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|Query environment variable (This capa rule had 1 match) [[3]](#3) |
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|Accept command line arguments (This capa rule had 2 matches) [[3]](#3) |
|[Persistence::Registry Run Keys / Startup Folder (E1547.001)](../persistence/registry-run-keys-startup-folder.md)|Persist via Run registry key (This capa rule had 1 match) [[3]](#3) |
|[Defense Evasion::Process Injection::Process Hollowing (E1055.012)](../defense-evasion/process-injection.md)|Use process replacement (This capa rule had 1 match) [[3]](#3) |

## MBC Behaviors

|Name|Use|
|---|---|
|[Impact::Remote Access (B0022)](../impact/remote-access.md)|The malware acts as a backdoor [[1]](#1) |
|[Anti-Behavioral Analysis::Conditional Execution::Runs as Service (B0025.007)](../execution/conditional-execution.md)|Run as service (This capa rule had 1 match) [[3]](#3) |
|[Anti-Behavioral Analysis::Debugger Detection::Anti-debugging Instructions (B0001.034)](../anti-behavioral-analysis/debugger-detection.md)|Execute anti-debugging instructions (This capa rule had 1 match) [[3]](#3) |
|[Anti-Behavioral Analysis::Debugger Detection::Software Breakpoints (B0001.025)](../anti-behavioral-analysis/debugger-detection.md)|Check for software breakpoints (This capa rule had 2 matches) [[3]](#3) |
|[Anti-Behavioral Analysis::Debugger Detection::Timing/Delay Check GetTickCount (B0001.032)](../anti-behavioral-analysis/debugger-detection.md)|Check for time delay via GetTickCount (This capa rule had 6 matches) [[3]](#3) |
|[Anti-Static Analysis::Disassembler Evasion::Argument Obfuscation (B0012.001)](../anti-static-analysis/disassembler-evasion.md)|Contain obfuscated stackstrings (This capa rule had 1 match) [[3]](#3) |
|[Command And Control::C2 Communication::Receive Data (B0030.002)](../command-and-control/c2-communication.md)|Receive data (This capa rule had 2 matches) [[3]](#3) |
|[Command And Control::C2 Communication::Send Data (B0030.001)](../command-and-control/c2-communication.md)|Send data (This capa rule had 2 matches) [[3]](#3) |
|[Communication::DNS Communication::Resolve (C0011.001)](../micro-behaviors/communication/dns-communication.md)|Resolve DNS (This capa rule had 1 match) [[3]](#3) |
|[Communication::Interprocess Communication::Create Pipe (C0003.001)](../micro-behaviors/communication/interprocess-communication.md)|Create two anonymous pipes (This capa rule had 1 match) [[3]](#3) |
|[Communication::Interprocess Communication::Write Pipe (C0003.004)](../micro-behaviors/communication/interprocess-communication.md)|Write pipe (This capa rule had 1 match) [[3]](#3) |
|[Communication::Socket Communication::Create UDP Socket (C0001.010)](../micro-behaviors/communication/socket-communication.md)|Create UDP socket (This capa rule had 1 match) [[3]](#3) |
|[Cryptography::Encrypt Data::3DES (C0027.004)](../micro-behaviors/cryptography/encrypt-data.md)|Encrypt data using DES (This capa rule had 1 match) [[3]](#3) |
|[Data::Compression Library (C0060)](../micro-behaviors/data/compression-library.md)|Linked against ZLIB (This capa rule had 1 match) [[3]](#3) |
|[Data::Encode Data::XOR (C0026.002)](../micro-behaviors/data/encode-data.md)|Encode data using XOR (This capa rule had 8 matches) [[3]](#3) |
|[Discovery::Code Discovery::Enumerate PE Sections (B0046.001)](../discovery/code-discovery.md)|Enumerate PE sections (This capa rule had 3 matches) [[3]](#3) |
|[File System::Copy File (C0045)](../micro-behaviors/file-system/copy-file.md)|Copy file (This capa rule had 1 match) [[3]](#3) |
|[File System::Create Directory (C0046)](../micro-behaviors/file-system/create-directory.md)|Create directory (This capa rule had 1 match) [[3]](#3) |
|[File System::Delete Directory (C0048)](../micro-behaviors/file-system/delete-directory.md)|Delete directory (This capa rule had 1 match) [[3]](#3) |
|[File System::Delete File (C0047)](../micro-behaviors/file-system/delete-file.md)|Delete file (This capa rule had 1 match) [[3]](#3) |
|[File System::Get File Attributes (C0049)](../micro-behaviors/file-system/get-file-attributes.md)|Get file attributes (This capa rule had 3 matches) [[3]](#3) |
|[File System::Move File (C0063)](../micro-behaviors/file-system/move-file.md)|Move file (This capa rule had 1 match) [[3]](#3) |
|[File System::Read File (C0051)](../micro-behaviors/file-system/read-file.md)|Read file on Windows (This capa rule had 1 match) [[3]](#3) |
|[File System::Set File Attributes (C0050)](../micro-behaviors/file-system/set-file-attributes.md)|Set file attributes (This capa rule had 1 match) [[3]](#3) |
|[File System::Write File (C0052)](../micro-behaviors/file-system/write-file.md)|Write file on Windows (This capa rule had 4 matches) [[3]](#3) |
|[Memory::Allocate Memory (C0007)](../micro-behaviors/memory/allocate-memory.md)|Allocate RWX memory (This capa rule had 4 matches) [[3]](#3) |
|[Operating System::Registry::Delete Registry Key (C0036.002)](../micro-behaviors/operating-system/registry.md)|Delete registry key (This capa rule had 1 match) [[3]](#3) |
|[Operating System::Registry::Delete Registry Value (C0036.007)](../micro-behaviors/operating-system/registry.md)|Delete registry value (This capa rule had 3 matches) [[3]](#3) |
|[Operating System::Registry::Query Registry Key (C0036.005)](../micro-behaviors/operating-system/registry.md)|Query or enumerate registry key (This capa rule had 4 matches) [[3]](#3) |
|[Operating System::Registry::Query Registry Value (C0036.006)](../micro-behaviors/operating-system/registry.md)|Query or enumerate registry value (This capa rule had 8 matches) [[3]](#3) |
|[Operating System::Registry::Set Registry Key (C0036.001)](../micro-behaviors/operating-system/registry.md)|Set registry value (This capa rule had 2 matches) [[3]](#3) |
|[Process::Create Mutex (C0042)](../micro-behaviors/process/create-mutex.md)|Create mutex (This capa rule had 1 match) [[3]](#3) |
|[Process::Create Process (C0017)](../micro-behaviors/process/create-process.md)|Create process on Windows (This capa rule had 9 matches) [[3]](#3) |
|[Process::Create Thread (C0038)](../micro-behaviors/process/create-thread.md)|Create thread (This capa rule had 6 matches) [[3]](#3) |
|[Process::Set Thread Local Storage Value (C0041)](../micro-behaviors/process/set-thread-local-storage-value.md)|Set thread local storage value (This capa rule had 1 match) [[3]](#3) |
|[Process::Suspend Thread (C0055)](../micro-behaviors/process/suspend-thread.md)|Suspend thread (This capa rule had 1 match) [[3]](#3) |
|[Process::Terminate Process (C0018)](../micro-behaviors/process/terminate-process.md)|Terminate process (This capa rule had 3 matches) [[3]](#3) |

## Indicators of Compromise

SHA256 Hashes
- 465d3aac3ca4daa9ad4de04fcb999f358396efd7abceed9701c9c28c23c126db
- 730e1337cf9ecf842a965ea458ee241c2a1e5b0ef1daccde87cd628eb4b37057

## References

<a name="1">[1]</a> https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/HUPIGON

<a name="2">[2]</a> https://www.f-secure.com/v-descs/backdoor_w32_hupigon.shtml

<a name="3">[3]</a> capa v4.0, analyzed at MITRE on 10/12/2022


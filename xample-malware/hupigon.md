<table>
<tr>
<td><b>ID</b></td>
<td><b>X0008</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>Delf, Emerleox, Logsnif, Graybird, Pcclient</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2013</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b>None</b></td>
</tr>
</table>


# Hupigon

A family of backdoors.

## ATT&CK Techniques

|Name|Use|
|---|---|
|[Collection::Clipboard Data (T1115)](https://attack.mitre.org/techniques/T1115)|Hupigon reads clipboard data. [[3]](#3)|
|[Defense Evasion::File and Directory Permissions Modification (T1222)](https://attack.mitre.org/techniques/T1222)|Hupigon sets file attributes. [[3]](#3)|
|[Defense Evasion::Hide Artifacts::Hidden Window (T1564.003)](https://attack.mitre.org/techniques/T1564/003)|Hupigon hides a graphical window. [[3]](#3)|
|[Discovery::Application Window Discovery (T1010)](https://attack.mitre.org/techniques/T1010)|Hupigon enumerates GUI resources. [[3]](#3)|
|[Discovery::System Location Discovery (T1614)](https://attack.mitre.org/techniques/T1614)|Hupigon gets geographical locations. [[3]](#3)|
|[Discovery::System Location Discovery::System Language Discovery (T1614.001)](https://attack.mitre.org/techniques/T1614/001)|Hupigon gets keyboard layouts. [[3]](#3)|
|[Discovery::System Network Configuration Discovery (T1016)](https://attack.mitre.org/techniques/T1016)|Hupigon gets local IPv4 addresses. [[3]](#3)|
|[Discovery::System Service Discovery (T1007)](https://attack.mitre.org/techniques/T1007)|Hupigon queries service status. [[3]](#3)|
|[Execution::Shared Modules (T1129)](https://attack.mitre.org/techniques/T1129)|Hupigon links many functions at runtime. [[3]](#3)|
|[Execution::System Services::Service Execution (T1569.002)](https://attack.mitre.org/techniques/T1569/002)|Hupigon creates services. [[3]](#3)|
|[Impact::Service Stop (T1489)](https://attack.mitre.org/techniques/T1489)|Hupigon stops services. [[3]](#3)|
|[Impact::System Shutdown/Reboot (T1529)](https://attack.mitre.org/techniques/T1529)|Hupigon shutdowns systems. [[3]](#3)|
|[Persistence::Create or Modify System Process::Windows Service (T1543.003)](https://attack.mitre.org/techniques/T1543/003)|Hupigon starts services. [[3]](#3)|
|[Privilege Escalation::Access Token Manipulation (T1134)](https://attack.mitre.org/techniques/T1134)|Hupigon acquires debug privileges. [[3]](#3)|

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Defense Evasion::Process Injection (E1055)](../defense-evasion/process-injection.md)|The malware injects itself into processes, such as cmd.exe and notepad.exe. [[2]](#2)|
|[Defense Evasion::Rootkit (E1014)](../defense-evasion/rootkit.md)|Certain Hupigon variants may have rootkit functionality. [[2]](#2)|
|[Collection::Keylogging (F0002)](../collection/keylogging.md)|Certain Hupigon variants may have keylogging functionality. [[2]](#2)|
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|Hupigon drops the file "Systen.dll" and adds the registry entry: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\BITS DllName = "%System%\Systen.dll". [[1]](#1)|
|[Defense Evasion::Modify Registry (E1112)](../defense-evasion/modify-registry.md)|The malware adds entries to the registry. [[1]](#1)|
|[Collection::Keylogging::Polling (F0002.002)](../collection/keylogging.md)|Hupigon logs keystrokes via polling. [[3]](#3)|
|[Collection::Screen Capture::WinAPI (E1113.m01)](../collection/screen-capture.md)|Hupigon captures screenshots. [[3]](#3)|
|[Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm (E1027.m02)](../defense-evasion/obfuscated-files-or-information.md)|Hupigon encodes data using XOR. [[3]](#3)|
|[Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm (E1027.m05)](../defense-evasion/obfuscated-files-or-information.md)|Hupigon encrypts data using DES. [[3]](#3)|
|[Discovery::Application Window Discovery::Window Text (E1010.m01)](../discovery/application-window-discovery.md)|Hupigon gets graphical window text. [[3]](#3)|
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|Hupigon enumerates files recursively. [[3]](#3)|
|[Discovery::File and Directory Discovery::Log File (E1083.m01)](../discovery/file-and-directory-discovery.md)|Hupigon accesses Windows event logs. [[3]](#3)|
|[Impact::Clipboard Modification (E1510)](../impact/clipboard-modification.md)|Hupigon replaces clipboard data. [[3]](#3)|
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|Hupigon queries environment variables. [[3]](#3)|
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|Hupigon accepts command line arguments. [[3]](#3)|
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|Hupigon persists via Run registry key. [[3]](#3)|
|[Defense Evasion::Process Injection::Process Hollowing (E1055.012)](../defense-evasion/process-injection.md)|Hupigon uses process replacement. [[3]](#3)|

## MBC Behaviors

|Name|Use|
|---|---|
|[Impact::Remote Access (B0022)](../impact/remote-access.md)|The malware acts as a backdoor. [[1]](#1)|
|[Execution::Conditional Execution::Runs as Service (B0025.007)](../execution/conditional-execution.md)|Hupigon runs as a service. [[3]](#3)|
|[Anti-Behavioral Analysis::Debugger Detection::Anti-debugging Instructions (B0001.034)](../anti-behavioral-analysis/debugger-detection.md)|Hupigon executes anti-debugging instructions. [[3]](#3)|
|[Anti-Behavioral Analysis::Debugger Detection::Software Breakpoints (B0001.025)](../anti-behavioral-analysis/debugger-detection.md)|Hupigon checks for software breakpoints. [[3]](#3)|
|[Anti-Behavioral Analysis::Debugger Detection::Timing/Delay Check GetTickCount (B0001.032)](../anti-behavioral-analysis/debugger-detection.md)|Hupigon checks for a time delay via GetTickCount. [[3]](#3)|
|[Anti-Static Analysis::Disassembler Evasion::Argument Obfuscation (B0012.001)](../anti-static-analysis/disassembler-evasion.md)|Hupigon contains obfuscated stack strings. [[3]](#3)|
|[Command And Control::C2 Communication::Receive Data (B0030.002)](../command-and-control/c2-communication.md)|Hupigon receives data. [[3]](#3)|
|[Command And Control::C2 Communication::Send Data (B0030.001)](../command-and-control/c2-communication.md)|Hupigon sends data. [[3]](#3)|
|[Communication::DNS Communication::Resolve (C0011.001)](../micro-behaviors/communication/dns-communication.md)|Hupigon resolves DNS. [[3]](#3)|
|[Communication::Interprocess Communication::Create Pipe (C0003.001)](../micro-behaviors/communication/interprocess-communication.md)|Hupigon creates two anonymous pipes. [[3]](#3)|
|[Communication::Interprocess Communication::Write Pipe (C0003.004)](../micro-behaviors/communication/interprocess-communication.md)|Hupigon writes pipes. [[3]](#3)|
|[Communication::Socket Communication::Create UDP Socket (C0001.010)](../micro-behaviors/communication/socket-communication.md)|Hupigon creates UDP sockets. [[3]](#3)|
|[Cryptography::Encrypt Data::3DES (C0027.004)](../micro-behaviors/cryptography/encrypt-data.md)|Hupigon encrypts data using DES. [[3]](#3)|
|[Data::Compression Library (C0060)](../micro-behaviors/data/compression-library.md)|Hupigon linked against ZLIB. [[3]](#3)|
|[Data::Encode Data::XOR (C0026.002)](../micro-behaviors/data/encode-data.md)|Hupigon encodes data using XOR. [[3]](#3)|
|[Discovery::Code Discovery::Enumerate PE Sections (B0046.001)](../discovery/code-discovery.md)|Hupigon enumerates PE sections. [[3]](#3)|
|[File System::Copy File (C0045)](../micro-behaviors/file-system/copy-file.md)|Hupigon copies files. [[3]](#3)|
|[File System::Create Directory (C0046)](../micro-behaviors/file-system/create-directory.md)|Hupigon creates directories. [[3]](#3)|
|[File System::Delete Directory (C0048)](../micro-behaviors/file-system/delete-directory.md)|Hupigon deletes directories. [[3]](#3)|
|[File System::Delete File (C0047)](../micro-behaviors/file-system/delete-file.md)|Hupigon deletes files. [[3]](#3)|
|[File System::Get File Attributes (C0049)](../micro-behaviors/file-system/get-file-attributes.md)|Hupigon gets file attributes. [[3]](#3)|
|[File System::Move File (C0063)](../micro-behaviors/file-system/move-file.md)|Hupigon moves files. [[3]](#3)|
|[File System::Read File (C0051)](../micro-behaviors/file-system/read-file.md)|Hupigon reads files on Windows. [[3]](#3)|
|[File System::Set File Attributes (C0050)](../micro-behaviors/file-system/set-file-attributes.md)|Hupigon sets file attributes. [[3]](#3)|
|[File System::Write File (C0052)](../micro-behaviors/file-system/writes-file.md)|Hupigon writes files on Windows. [[3]](#3)|
|[Memory::Allocate Memory (C0007)](../micro-behaviors/memory/allocate-memory.md)|Hupigon allocates RWX memory. [[3]](#3)|
|[Operating System::Registry::Delete Registry Key (C0036.002)](../micro-behaviors/operating-system/registry.md)|Hupigon deletes registry keys. [[3]](#3)|
|[Operating System::Registry::Delete Registry Value (C0036.007)](../micro-behaviors/operating-system/registry.md)|Hupigon deletes registry values. [[3]](#3)|
|[Operating System::Registry::Query Registry Key (C0036.005)](../micro-behaviors/operating-system/registry.md)|Hupigon queries or enumerates registry keys. [[3]](#3)|
|[Operating System::Registry::Query Registry Value (C0036.006)](../micro-behaviors/operating-system/registry.md)|Hupigon queries or enumerates registry values. [[3]](#3)|
|[Operating System::Registry::Set Registry Key (C0036.001)](../micro-behaviors/operating-system/registry.md)|Hupigon sets registry values. [[3]](#3)|
|[Process::Create Mutex (C0042)](../micro-behaviors/process/create-mutex.md)|Hupigon creates mutexes. [[3]](#3)|
|[Process::Create Process (C0017)](../micro-behaviors/process/create-process.md)|Hupigon creates processes on Windows. [[3]](#3)|
|[Process::Create Thread (C0038)](../micro-behaviors/process/create-thread.md)|Hupigon creates threads. [[3]](#3)|
|[Process::Set Thread Local Storage Value (C0041)](../micro-behaviors/process/set-thread-local-storage-value.md)|Hupigon sets thread local storage values. [[3]](#3)|
|[Process::Suspend Thread (C0055)](../micro-behaviors/process/suspend-thread.md)|Hupigon suspends threads. [[3]](#3)|
|[Process::Terminate Process (C0018)](../micro-behaviors/process/terminate-process.md)|Hupigon terminates processes. [[3]](#3)|

## Indicators of Compromise

SHA256 Hashes
- 465d3aac3ca4daa9ad4de04fcb999f358396efd7abceed9701c9c28c23c126db
- 730e1337cf9ecf842a965ea458ee241c2a1e5b0ef1daccde87cd628eb4b37057

## References

<a name="1">[1]</a> https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/HUPIGON

<a name="2">[2]</a> https://www.f-secure.com/v-descs/backdoor_w32_hupigon.shtml

<a name="3">[3]</a> capa v4.0, analyzed at MITRE on 10/12/2022


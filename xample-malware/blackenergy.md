<table>
<tr>
<td><b>ID</b></td>
<td><b>X0002</b></td>
</tr>
<tr>
<td><b>Type</b></td>
<td><b>Bot/Botnet</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2007</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b><a href="https://attack.mitre.org/software/S0089/">BlackEnergy</a></b></td>
</tr>
</table>


# BlackEnergy

An HTTP-based botnet used mostly for DDoS attacks. [[1]](#1)

## ATT&CK Techniques

|Name|Use|
|---|---|
|[Execution::Shared Modules (T1129)](https://attack.mitre.org/techniques/T1129)|BlackEnergy accesses PEB ldr_data. [[4]](#4)|

See ATT&CK: [BlackEnergy - Techniques Used](https://attack.mitre.org/software/S0089/).

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Defense Evasion::Process Injection::Injection using Shims (E1055.m05)](../defense-evasion/process-injection.md)|Malware bypasses UAC using a Shim Database instructing SndVol.exe to execute cmd.exe instead, allowing for elevated execution. [[1]](#1)|
|[Defense Evasion::Install Insecure or Malicious Configuration (B0047)](../defense-evasion/install-insecure-or-malicious-configuration.md)|Malware configures the system to the TESTSIGNING boot configuration option to load its unsigned driver component. [[1]](#1)|
|[Defense Evasion::Indicator Blocking (F0006)](../defense-evasion/indicator-blocking.md)|Malware clears windows event logs and removes the watermark associated with enabling the TESTSIGNING boot configuration option by removing the relevent strings in the user32.dll.mui of the system. [[1]](#1)|
|[Persistence::Modify Existing Service (F0011)](../persistence/modify-existing-service.md)|Malware locates an inactive driver service to Hijack and set it to start automatically. [[1]](#1)|
|[Defense Evasion::Process Injection (E1055)](../defense-evasion/process-injection.md)|Malware injects its dll component into svchost.exe. [[1]](#1)|
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|Malware uses Systeminfo to gather OS version, system configuration, BIOS, the motherboard, and processor. [[1]](#1)|
|[Collection::Keylogging (F0002)](../collection/keylogging.md)|Keylogger plugin allows for collection of keystrokes. [[2]](#2)|
|[Collection::Screen Capture (E1113)](../collection/screen-capture.md)|Malware contains a screenshot plugin that allows for the collection of screenshots. [[2]](#2)|
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|BlackEnergy 3 variant drops its main DLL component and then creates a .lnk shortcut to that file in the startup folder, allowing it to persist via a Run registry key. [[1]](#1) [[4]](#4)|
|[Impact::Data Destruction (E1485)](../impact/data-destruction.md)|BlackEnergy 2 variant contains a Destroy plugin that destroys data stored on victim hard drives by overwriting file contents. [[3]](#3)|
|[Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm (E1027.m05)](../defense-evasion/obfuscated-files-or-information.md)|BlackEnergy encrypts data using RC4 via WinAPI. [[4]](#4)|
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|BlackEnergy gets the common file path. [[4]](#4)|

## MBC Behaviors

|Name|Use|
|---|---|
|[Impact::Denial of Service (B0033)](../impact/denial-of-service.md)|Malware was originally built to launch a distributed denial of service attacks that can target more than one IP address per hostname. [[1]](#1)|
|[Execution::Remote Commands (B0011)](../execution/remote-commands.md)|Malware-infected bots receive commands from botmaster to load plugins associated with botmaster's goals. [[1]](#1)|
|[Anti-Static Analysis::Disassembler Evasion::Argument Obfuscation (B0012.001)](../anti-static-analysis/disassembler-evasion.md)|BlackEnergy contains obfuscated stack strings. [[4]](#4)|
|[Communication::HTTP Communication::Extract Body (C0002.011)](../micro-behaviors/communication/http-communication.md)|BlackEnergy extracts the HTTP body. [[4]](#4)|
|[Communication::HTTP Communication::IWebBrowser (C0002.010)](../micro-behaviors/communication/http-communication.md)|The malware initializes IWebBrowser2. [[4]](#4)|
|[Cryptography::Cryptographic Hash (C0029)](../micro-behaviors/cryptography/cryptographic-hash.md)|BlackEnergy hashes data via WinCrypt. [[4]](#4)|
|[Cryptography::Cryptographic Hash::MD5 (C0029.001)](../micro-behaviors/cryptography/cryptographic-hash.md)|BlackEnergy hashes data with MD5. [[4]](#4)|
|[Cryptography::Cryptographic Hash::SHA1 (C0029.002)](../micro-behaviors/cryptography/cryptographic-hash.md)|BlackEnergy hashes data using SHA1. [[4]](#4)|
|[Cryptography::Decrypt Data (C0031)](../micro-behaviors/cryptography/decrypt-data.md)|BlackEnergy encrypts or decrypts via WinCrypt. [[4]](#4)|
|[Cryptography::Encrypt Data::RC4 (C0027.009)](../micro-behaviors/cryptography/encrypt-data.md)|BlackEnergy encrypts data using RC4 via WinAPI. [[4]](#4)|
|[Cryptography::Encryption Key (C0028)](../micro-behaviors/cryptography/encryption-key.md)|BlackEnergy creates new key via CryptAcquireContext. [[4]](#4)|
|[Cryptography::Generate Pseudo-random Sequence::Use API (C0021.003)](../micro-behaviors/cryptography/generate-pseudorandom-sequence.md)|BlackEnergy generates random numbers via WinAPI. [[4]](#4)|
|[Discovery::Code Discovery::Enumerate PE Sections (B0046.001)](../discovery/code-discovery.md)|BlackEnergy enumerates PE sections. [[4]](#4)|
|[Operating System::Registry::Query Registry Key (C0036.005)](../micro-behaviors/operating-system/registry.md)|BlackEnergy queries or enumerates a registry key. [[4]](#4)|
|[Operating System::Registry::Query Registry Value (C0036.006)](../micro-behaviors/operating-system/registry.md)|BlackEnergy queries or enumerates a registry value. [[4]](#4)|
|[Process::Create Process (C0017)](../micro-behaviors/process/create-process.md)|BlackEnergy creates a process on Windows. [[4]](#4)|
|[Process::Terminate Process (C0018)](../micro-behaviors/process/terminate-process.md)|BlackEnergy terminates a process via fastfail. [[4]](#4)|

## Indicators of Compromise

SHA256 Hashes
- e791718c0141e3829608142fb0f0d35c9af270f78ae0b72fce2edd07a9684568 
- d841d9092239fc029b10da01c19868749b0f6bd757926ff04674658468495808 
- bc062acda428f55782710f9c4f2df88c26dfbc004b94b479459f8572b1219444
- 16d68b740b5d9aa60929e39fd616d31be2c8528d0f1e58db4cbb16976f7cd725
- af62f29ac01e8335bf41c02c1460ebafcbaf94956b1001f7d515eecf63cea4f2
- 47aea6a4e1da1fb8b454c038c21736bee53d59d095a4f5b866d5dd8158fead41
- 4b2efcda5269f4b80dc417a2b01332185f2fafabd8ba7114fa0306baaab5a72d
- b1ca89de93a1d9bf17cdbf8a3c61e7f52f275a3bcbbd285d35d6a40c45dde9bd
- 951e5623c20d4e9ab158fe105436389dbf61327b2c87b7fb36f8ad3ff5ad9bde
- f8b974cf978a3828aeb9b83fc48645da576e4b90dd47c2b82a46f6c14665a9e5
- 91f72808aaed45a76ff1044a23fd6df4b7ab7ace292725522518feb9c0b8574e
- 2aade7381aa87f55b7d7a5284d22be5472fd8cd966d216fd4445ca3a8bbb3ff3 
- 01425582aa5001342b985270a365fd92d909be011384247e81872bff586fa142
- 9e9a6f1d046e0f5da10aa0e18bba248df4f818d342ed359c35fdb000f1354819

## References

<a name="1">[1]</a> https://blog-assets.f-secure.com/wp-content/uploads/2019/10/15163408/BlackEnergy_Quedagh.pdf

<a name="2">[2]</a> https://securelist.com/be2-custom-plugins-router-abuse-and-target-profiles/67353/

<a name="3">[3]</a> https://securelist.com/be2-extraordinary-plugins-siemens-targeting-dev-fails/68838/

<a name="4">[4]</a> capa v4.0, analyzed at MITRE on 10/12/2022


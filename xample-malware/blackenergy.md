
<table>
<tr>
<td><b>ID</b></td>
<td><b>X0002</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2007</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b><a href="https://attack.mitre.org/software/S0089/">BlackEnergy</a></b></td>
</tr>
</table>


BlackEnergy
===========
An HTTP-based botnet used mostly for DDoS attacks. [[1]](#1)


ATT&CK Techniques
-----------------
See ATT&CK: [BlackEnergy - Techniques Used](https://attack.mitre.org/software/S0089/).

Enhanced ATT&CK Techniques
---------
|Name|Use|
|---|---|
|[Defense Evasion::Process Injection::Injection using Shims (E1055.m05)](../defense-evasion/process-injection.md)|Bypasses UAC using a Shim Database instructing SndVol.exe to execute cmd.exe instead, allowing for elevated execution  [[1]](#1)|
|[Defense Evasion::Install Insecure or Malicious Configuration (E1479)](../defense-evasion/install-insecure-or-malicious-configuration.md)|Configures the system to the TESTSIGNING boot configuration option to load its unsigned driver component [1] [[1]](#1)|
|[Defense Evasion::Indicator Blocking (F0006)](../defense-evasion/indicator-blocking.md)|Clears windows event logs and removes the watermark associated with enabling the TESTSIGNING boot configuration option by removing the relevent strings in the user32.dll.mui of the system  [[1]](#1)|
|[Persistence::Modify Existing Service (F0011)](../persistence/modify-existing-service.md)|Locates an inactive driver service to Hijack and set it to start automatically [[1]](#1)|
|[Defense Evasion::Process Injection (E1055)](../defense-evasion/process-injection.md)|injects its dll component into svchost.exe  [[1]](#1)|
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|uses Systeminfo to gather OS version, system configuration, BIOS, the motherboard, and processor [ [[1]](#1)|
|[Collection::Keylogging (F0002)](../collection/keylogging.md)|Keylogger plugin allows for collection of keystrokes [[2]](#2)|
|[Collection::Screen Capture (E1113)](../collection/screen-capture.md)|Screenshot plugin allows for collection of screenshots  [[2]](#2)|
|[Persistence::Registy Run Keys / Startup folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|BlackEnergy 3 variant drops its main DLL component and then creates a .lnk shortcut to that file in the startup folder  [[1]](#1)|
|[Impact::Data Destruction (E1485)](../impact/data-destruction.md)|BlackEnergy 2 variant contains a Destroy plugin that destroys data stored on victim hard drives by overwriting file contents  [[3]](#3)|

MBC Behaviors
---------
|Name|Use|
|---|---|
|[Impact::Denial of Service (B0033)](../impact/denial-of-service.md)|Originally built to launch distributed denial of service attacks that can target more than one IP address per hostname  [[1]](#1)|
|[Execution::Remote Commands (B0011)](../execution/remote-commands.md)|infected bots receive commands from botmaster to load plugins associated with botmaster's goals [[1]](#1)|

Indicators of Compromise
------------------------
MD5 Hashes
- 26b9816b3f9e2f350cc92ef4c30a097c6fec7798 
- bf9937489cb268f974d3527e877575b4fbb07cb0 
- 78636f7bbd52ea80d79b4e2a7882403092bbb02d
- bf9172e87e9264d1cddfc36cbaa74402bb405708
- 441cfbaba1dfd58ce03792ef74d183529e8e0104
- f7d4aa90b76646f4a011585eb43b9d13c60f48eb
- 8ccd2962bce8985d0794daed6e0bf73e5557cfe8
- d496f99f7e07d5cbbd177a9d43febe8fb87ebc3b
- cc71aa8f919911676fb5d775c81afc682e6e3dd3
- abab02d663872bcdbe2e008441fcd7157c0eb52d
- e5c8c10b10ee288512d3a7c79ae1249b57857d23
- 8743c8994cc1e8219697394b5cb494efa7dad796 
- 285b3252a878d1c633ea988153bbc23c148dd630


References
----------
<a name="1">[1]</a> https://blog-assets.f-secure.com/wp-content/uploads/2019/10/15163408/BlackEnergy_Quedagh.pdf

<a name="2">[2]</a> https://securelist.com/be2-custom-plugins-router-abuse-and-target-profiles/67353/

<a name="3">[3]</a> https://securelist.com/be2-extraordinary-plugins-siemens-targeting-dev-fails/68838/

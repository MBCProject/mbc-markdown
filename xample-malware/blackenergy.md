
<table>
<tr>
<td><b>ID</b></td>
<td><b>X0002</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2007</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b><a href="https://attack.mitre.org/software/S0089/">BlackEnergy</a></b></td>
</tr>
</table>


# BlackEnergy

An HTTP-based botnet used mostly for DDoS attacks. [[1]](#1)


ATT&CK Techniques
-----------------
See ATT&CK: [BlackEnergy - Techniques Used](https://attack.mitre.org/software/S0089/).

Enhanced ATT&CK Techniques
---------
|Name|Use|
|---|---|
|[Defense Evasion::Process Injection::Injection using Shims (E1055.m05)](../defense-evasion/process-injection.md)|Bypasses UAC using a Shim Database instructing SndVol.exe to execute cmd.exe instead, allowing for elevated execution  [[1]](#1)|
|[Defense Evasion::Install Insecure or Malicious Configuration (E1479)](../defense-evasion/install-insecure-or-malicious-configuration.md)|Configures the system to the TESTSIGNING boot configuration option to load its unsigned driver component [1] [[1]](#1)|
|[Defense Evasion::Indicator Blocking (F0006)](../defense-evasion/indicator-blocking.md)|Clears windows event logs and removes the watermark associated with enabling the TESTSIGNING boot configuration option by removing the relevent strings in the user32.dll.mui of the system  [[1]](#1)|
|[Persistence::Modify Existing Service (F0011)](../persistence/modify-existing-service.md)|Locates an inactive driver service to Hijack and set it to start automatically [[1]](#1)|
|[Defense Evasion::Process Injection (E1055)](../defense-evasion/process-injection.md)|injects its dll component into svchost.exe  [[1]](#1)|
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|uses Systeminfo to gather OS version, system configuration, BIOS, the motherboard, and processor [ [[1]](#1)|
|[Collection::Keylogging (F0002)](../collection/keylogging.md)|Keylogger plugin allows for collection of keystrokes [[2]](#2)|
|[Collection::Screen Capture (E1113)](../collection/screen-capture.md)|Screenshot plugin allows for collection of screenshots  [[2]](#2)|
|[Persistence::Registy Run Keys / Startup folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|BlackEnergy 3 variant drops its main DLL component and then creates a .lnk shortcut to that file in the startup folder  [[1]](#1)|
|[Impact::Data Destruction (E1485)](../impact/data-destruction.md)|BlackEnergy 2 variant contains a Destroy plugin that destroys data stored on victim hard drives by overwriting file contents  [[3]](#3)|

MBC Behaviors
---------
|Name|Use|
|---|---|
|[Impact::Denial of Service (B0033)](../impact/denial-of-service.md)|Originally built to launch distributed denial of service attacks that can target more than one IP address per hostname  [[1]](#1)|
|[Execution::Remote Commands (B0011)](../execution/remote-commands.md)|infected bots receive commands from botmaster to load plugins associated with botmaster's goals [[1]](#1)|

Indicators of Compromise
------------------------
SHA256 Hashes
- e791718c0141e3829608142fb0f0d35c9af270f78ae0b72fce2edd07a9684568 
- d841d9092239fc029b10da01c19868749b0f6bd757926ff04674658468495808 
- bc062acda428f55782710f9c4f2df88c26dfbc004b94b479459f8572b1219444
- 16d68b740b5d9aa60929e39fd616d31be2c8528d0f1e58db4cbb16976f7cd725
- af62f29ac01e8335bf41c02c1460ebafcbaf94956b1001f7d515eecf63cea4f2
- 47aea6a4e1da1fb8b454c038c21736bee53d59d095a4f5b866d5dd8158fead41
- 4b2efcda5269f4b80dc417a2b01332185f2fafabd8ba7114fa0306baaab5a72d
- b1ca89de93a1d9bf17cdbf8a3c61e7f52f275a3bcbbd285d35d6a40c45dde9bd
- 951e5623c20d4e9ab158fe105436389dbf61327b2c87b7fb36f8ad3ff5ad9bde
- f8b974cf978a3828aeb9b83fc48645da576e4b90dd47c2b82a46f6c14665a9e5
- 91f72808aaed45a76ff1044a23fd6df4b7ab7ace292725522518feb9c0b8574e
- 2aade7381aa87f55b7d7a5284d22be5472fd8cd966d216fd4445ca3a8bbb3ff3 
- 01425582aa5001342b985270a365fd92d909be011384247e81872bff586fa142


## References

<a name="1">[1]</a> https://blog-assets.f-secure.com/wp-content/uploads/2019/10/15163408/BlackEnergy_Quedagh.pdf

<a name="2">[2]</a> https://securelist.com/be2-custom-plugins-router-abuse-and-target-profiles/67353/

<a name="3">[3]</a> https://securelist.com/be2-extraordinary-plugins-siemens-targeting-dev-fails/68838/

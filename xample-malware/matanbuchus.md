
<table>
<tr>
<td><b>ID</b></td>
<td><b>X0035</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2021</b></td>
</tr>
</table>


# Matanbuchus

A commercial loader that consists of 2 stages used to download and execute payloads.


## ATT&CK Techniques

|Name|Use|
|---|---|
|[Privilege Escalation::Process Injection::Dynamic-Link  (T1055.001)](https://attack.mitre.org/techniques/T1055/001/)|Malware loads every part of the malware from different DLLs.  [[1]](#1) [[2]](#2)|
|[Defense Evasion::System Binary Proxy Execution::Regsvr32 (T1218.010)](https://attack.mitre.org/techniques/T1218/010/)|Malware downloads a DLL from a remote server and launches it through regsvr32. In some cases, the loader saves the payload as an .ocx extension. [[1]](#1) [[2]](#2)|
|[Discovery::File and Directory Discovery (T1083)](https://attack.mitre.org/techniques/T1083/)|Malware queries target computer for a target folder.  [[1]](#1)|
|[Execution::Scheduled Task/Job::Scheduled Task (T1053.005)](https://attack.mitre.org/techniques/T1053/005/)|Malware schedules a task to execute regsvr32.exe  every 3 minutes.  [[1]](#1)|
|[Discovery::System Location Discovery::System Language Discovery (T1614.001)](https://attack.mitre.org/techniques/T1614/001/)|Malware checks the language ID for the victim computer's language. If the language is part of the Commonwealth of Independent States (CIS), then the malware terminates.  [[2]](#2)|
|[Discovery::Query Registry (T1012)](https://attack.mitre.org/techniques/T1012/)|Malware loader retrieves the network domain name and computer name.  [[2]](#2)|
|[Discovery::System Information Discovery (T1082)](https://attack.mitre.org/techniques/T1082/)|Malware loader collects the full path of the process running the loader, basic CPU information, machine architecture, number of processors, victim logon server's name, RAM size, DNS domain, and MAC address.  [[2]](#2)|
|[Persistence::Create or Modify System Process::Windows Service (T1543.003)](https://attack.mitre.org/techniques/T1543/003/)|Malware loader creates a new instance of explorer.exe.  [[2]](#2)|
|[Execution::Command and Scripting Interpreter::Windows Command Shell (T1059.003)](https://attack.mitre.org/techniques/T1059/003/)|Malware loader runs cmd.exe to start payload with admin privileges. The loader can also act like a bot.  [[2]](#2)|
|[Defense Evasion::System Binary Proxy Execution::Rundll32 (T1218.011)](https://attack.mitre.org/techniques/T1218/011/)|Malware loader executes DLLs by using rundll32.exe.  [[2]](#2)|
|[Execution::Command and Scripting Interpreter::PowerShell (T1059.001)](https://attack.mitre.org/techniques/T1059/001/)|Malware loader can run PowerShell commands.  [[2]](#2)|


## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Persistence::Ingress Tool Transfer (E1105)](../command-and-control/ingress-tool-transfer.md)|Malware downloads the latest version of itself fromm a remote server.  [[1]](#1)|
|[Persistence::Registry Run Keys/Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|Malware adds registry key to enable startup after reboot. [[1]](#1)|
|[Defense Evasion::Hidden Files and Directories::Location (F0005.002)](../defense-evasion/hidden-files-and-directories.md)|Malware is located on external drives or network shares and attaches itself to any ZIP or RAR files, removable drives, and network shares. The malware hides all folders present in the external drive and drops an executable with the same name and a disguished folder icon.  [[1]](#1)|
|[Execution::User Execution (E1204)](../execution/user-execution.md)|Users double-click the malicious executable.  [[1]](#1)|
|[Defense Evasion::Disable or Evade Security Tools (F0004)](../defense-evasion/disable-or-evade-security-tools.md)|Malware uses GetModuleHandle API call to check for presence of Avast Antivirus. [[1]](#1)|
|[Persistence::Modify Existing Service (F0011)](../persistence/modify-existing-service.md)|Malware disables Windows AutoUpdate feature on the infected system. Malware patches the first byte of TerminateProcess and TerminateThread API with C3 (RET Instruction) to prevent any external processes from terminating the running instance of the malware. [[1]](#1)|


## MBC Behaviors

|Name|Use|
|---|---|
|[Anti-Behavioral Analysis::Capture Evasion::Encrypted Payloads (B0036.002)](../anti-behavioral-analysis/capture-evasion.md)|Malware is downloaded in encrypted form and then decrypted.  [[1]](#1)|
|[Execution::Install Additional Program (B0023)](../execution/install-additional-program.md)|Malware downloads other malware family executables. [[1]](#1)|
|[Anti-Behavioral Analysis::Debugger Evasion (B0002)](../anti-behavioral-analysis/debugger-evasion.md)|Malware uses GetModuleHandle API call to check for presence of debugger. [[1]](#1)|
|[Anti-Behavioral Analysis::Sandbox Detection (B0007)](../anti-behavioral-analysis/sandbox-detection.md)|Malware uses GetModuleHandle API call to check for the presence of sandbox. [[1]](#1)|
|[Anti-Behavioral Analysis::Virtual Machine Detection (B0009)](../anti-behavioral-analysis/virtual-machine-detection.md)|Malware checks for the presence of virtualization software, such as VMware, VirtualBox, and QEMU by querying the system registry. [[1]](#1)|


## References

<a name="1">[1]</a> https://www.0ffset.net/reverse-engineering/matanbuchus-loader-analysis/

<a name="2">[2]</a> https://www.cyberark.com/resources/threat-research-blog/inside-matanbuchus-a-quirky-loader


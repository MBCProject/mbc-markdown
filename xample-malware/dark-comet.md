<table>
<tr>
<td><b>ID</b></td>
<td><b>X0004</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2008</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b><a href="https://attack.mitre.org/software/S0334/">DarkComet</a></b></td>
</tr>
</table>


# Dark Comet

A Remote Access Trojan (RAT) that allows a user to control the system via a GUI. It has many features which allows a user to use it as administrative remote help tool; however, DarkComet has many features which can be used maliciously. DarkComet is commonly used to spy on the victims by taking screen captures, key-logging, or password stealing. [[1]](#1)

## ATT&CK Techniques

|Name|Use|
|---|---|
|[Collection::Clipboard Data (T1115)](https://attack.mitre.org/techniques/T1115)|Read clipboard data (This capa rule had 8 matches) [[4]](#4) |
|[Defense Evasion::Hide Artifacts::Hidden Window (T1564.003)](https://attack.mitre.org/techniques/T1564/003)|Hide graphical window (This capa rule had 8 matches) [[4]](#4) |
|[Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks (T1497.002)](https://attack.mitre.org/techniques/T1497/002)|Check for unmoving mouse cursor (This capa rule had 1 match) [[4]](#4) |
|[Discovery::Application Window Discovery (T1010)](https://attack.mitre.org/techniques/T1010)|Enumerate gui resources (This capa rule had 3 matches) [[4]](#4) |
|[Discovery::Process Discovery (T1057)](https://attack.mitre.org/techniques/T1057)|Get process heap force flags (This capa rule had 1 match) [[4]](#4) |
|[Discovery::System Location Discovery (T1614)](https://attack.mitre.org/techniques/T1614)|Get geographical location (This capa rule had 5 matches) [[4]](#4) |
|[Discovery::System Location Discovery::System Language Discovery (T1614.001)](https://attack.mitre.org/techniques/T1614/001)|Get keyboard layout (This capa rule had 4 matches) [[4]](#4) |
|[Execution::Shared Modules (T1129)](https://attack.mitre.org/techniques/T1129)|Parse PE header (This capa rule had 1 match) [[4]](#4) |

See ATT&CK: [Dark Comet - Techniques Used](https://attack.mitre.org/software/S0334/).

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Collection::Keylogging (F0002)](../collection/keylogging.md)|DarkComet can capture keystrokes [[2]](#2) |
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|Adds several registry entries to enable automatic execution at startup  [[2]](#2) |
|[Defense Evasion::Indicator Blocking (F0006)](../defense-evasion/indicator-blocking.md)|Can disable security center functions like anti-virus and firewall [[2]](#2) |
|[Command and Control::Ingress Tool Transfer (E1105)](../command-and-control/ingress-tool-transfer.md)|Can download files from remote repository upon instruction [[2]](#2) |
|[Anti-Static Analysis::Software Packing (F0001)](../anti-static-analysis/software-packing.md)|Has the option to compress its payload using UPX or MPRESS  [[2]](#2) |
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|Can collect information about the computer, resources, and operating system version [[2]](#2) Get disk size (This capa rule had 1 match) [[4]](#4)|
|[Collection::Keylogging::Polling (F0002.002)](../collection/keylogging.md)|Log keystrokes via polling (This capa rule had 10 matches) [[4]](#4) |
|[Collection::Screen Capture::WinAPI (E1113.m01)](../collection/screen-capture.md)|Capture screenshot (This capa rule had 1 match) [[4]](#4) |
|[Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm (E1027.m02)](../defense-evasion/obfuscated-files-or-information.md)|Encode data using XOR (This capa rule had 13 matches) [[4]](#4) |
|[Discovery::Application Window Discovery::Window Text (E1010.m01)](../discovery/application-window-discovery.md)|Get graphical window text (This capa rule had 2 matches) [[4]](#4) |
|[Impact::Clipboard Modification (E1510)](../impact/clipboard-modification.md)|Write clipboard data (This capa rule had 4 matches) [[4]](#4) |
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|Get file version info (This capa rule had 1 match) [[4]](#4) |
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|Accept command line arguments (This capa rule had 2 matches) [[4]](#4) |

## MBC Behaviors

|Name|Use|
|---|---|
|[Impact::Remote Access (B0022)](../impact/remote-access.md)|Allows an attacker to control the system via a GUI  [[1]](#1) |
|[Anti-Behavioral Analysis::Debugger Detection::Timing/Delay Check GetTickCount (B0001.032)](../anti-behavioral-analysis/debugger-detection.md)|Check for time delay via GetTickCount (This capa rule had 4 matches) [[4]](#4) |
|[Anti-Behavioral Analysis::Virtual Machine Detection::Human User Check (B0009.012)](../anti-behavioral-analysis/virtual-machine-detection.md)|Check for unmoving mouse cursor (This capa rule had 1 match) [[4]](#4) |
|[Cryptography::Encrypt Data::RC4 (C0027.009)](../micro-behaviors/cryptography/encrypt-data.md)|Encrypt data using RC4 PRGA (This capa rule had 3 matches) [[4]](#4) |
|[Data::Checksum::CRC32 (C0032.001)](../micro-behaviors/data/checksum.md)|Hash data with CRC32 (This capa rule had 5 matches) [[4]](#4) |
|[Data::Compression Library (C0060)](../micro-behaviors/data/compression-library.md)|Linked against ZLIB (This capa rule had 1 match) [[4]](#4) |
|[Data::Encode Data::XOR (C0026.002)](../micro-behaviors/data/encode-data.md)|Encode data using XOR (This capa rule had 13 matches) [[4]](#4) |
|[Discovery::Code Discovery::Enumerate PE Sections (B0046.001)](../discovery/code-discovery.md)|Enumerate PE sections (This capa rule had 3 matches) [[4]](#4) |
|[Execution::Install Additional Program (B0023)](../execution/install-additional-program.md)|Contain an embedded PE file (This capa rule had 1 match) [[4]](#4) |
|[File System::Delete File (C0047)](../micro-behaviors/file-system/delete-file.md)|Delete file (This capa rule had 1 match) [[4]](#4) |
|[File System::Get File Attributes (C0049)](../micro-behaviors/file-system/get-file-attributes.md)|Get file attributes (This capa rule had 2 matches) [[4]](#4) |
|[File System::Read File (C0051)](../micro-behaviors/file-system/read-file.md)|Read file on Windows (This capa rule had 7 matches) [[4]](#4) |
|[File System::Write File (C0052)](../micro-behaviors/file-system/writes-file.md)|Writes Fileon Windows (This capa rule had 5 matches) [[4]](#4) |
|[Memory::Allocate Memory (C0007)](../micro-behaviors/memory/allocate-memory.md)|Allocate RWX memory (This capa rule had 1 match) [[4]](#4) |
|[Operating System::Registry::Delete Registry Key (C0036.002)](../micro-behaviors/operating-system/registry.md)|Delete registry key (This capa rule had 1 match) [[4]](#4) |
|[Operating System::Registry::Delete Registry Value (C0036.007)](../micro-behaviors/operating-system/registry.md)|Delete registry value (This capa rule had 1 match) [[4]](#4) |
|[Operating System::Registry::Query Registry Key (C0036.005)](../micro-behaviors/operating-system/registry.md)|Query or enumerate registry key (This capa rule had 3 matches) [[4]](#4) |
|[Operating System::Registry::Query Registry Value (C0036.006)](../micro-behaviors/operating-system/registry.md)|Query or enumerate registry value (This capa rule had 6 matches) [[4]](#4) |
|[Operating System::Registry::Set Registry Key (C0036.001)](../micro-behaviors/operating-system/registry.md)|Set registry value (This capa rule had 1 match) [[4]](#4) |
|[Process::Create Process (C0017)](../micro-behaviors/process/create-process.md)|Create process on Windows (This capa rule had 6 matches) [[4]](#4) |
|[Process::Create Thread (C0038)](../micro-behaviors/process/create-thread.md)|Create thread (This capa rule had 3 matches) [[4]](#4) |
|[Process::Resume Thread (C0054)](../micro-behaviors/process/resume-thread.md)|Resume thread (This capa rule had 2 matches) [[4]](#4) |
|[Process::Set Thread Local Storage Value (C0041)](../micro-behaviors/process/set-thread-local-storage-value.md)|Set thread local storage value (This capa rule had 1 match) [[4]](#4) |
|[Process::Suspend Thread (C0055)](../micro-behaviors/process/suspend-thread.md)|Suspend thread (This capa rule had 1 match) [[4]](#4) |

## Indicators of Compromise

SHA256 Hashes
- 0369aa99d731d2de260bc63b6c4f85d997eb189155c362df478d8f5afaa655b0
- 0bb88564a22bfd6d9ad6e4d8efa9077792a7b6094c2a0f865d70c43e11507352

## References

<a name="1">[1]</a> https://en.wikipedia.org/wiki/DarkComet

<a name="2">[2]</a> https://blog.malwarebytes.com/threat-analysis/2012/06/you-dirty-rat-part-1-darkcomet/

<a name="3">[3]</a> https://bazaar.abuse.ch/browse/signature/DarkComet/

<a name="4">[4]</a> capa v4.0, analyzed at MITRE on 10/12/2022


<table>
<tr>
<td><b>ID</b></td>
<td><b>X0028</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>Geodo</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2018</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b>None</b></td>
</tr>
</table>


# Emotet

Emotet is a banking trojan. [[1]](#1)

## ATT&CK Techniques

|Name|Use|
|---|---|
|[Execution::Shared Modules (T1129)](https://attack.mitre.org/techniques/T1129)|Emotet parses PE headers. [[6]](#6)|

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Anti-Static Analysis::Software Packing::Custom Compression (F0001.005)](../anti-static-analysis/software-packing.md)|Emotet uses custom packers which first decrypt the loaders, and then the loaders decrypt and load Emotet's main payloads. [[2]](#2)|
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|Emotet collects information related to OS, processes, and sometimes mail client information and sends it to C2. [[2]](#2)|
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|To start itself at system boot, Emotet adds the downloaded payload to the registry to maintain persistence. [[1]](#1)|
|[Impact::Clipboard Modification (E1510)](../impact/clipboard-modification.md)|Emotet writes clipboard data. [[6]](#6)|


## MBC Behaviors

|Name|Use|
|---|---|
|[Anti-Static Analysis::Executable Code Obfuscation::Junk Code Insertion (B0032.007)](../anti-static-analysis/executable-code-obfuscation.md)|Emotet macros are heavily obfuscated with junk functions and string substitutions. [[1]](#1)|
|[Micro-behaviors::Cryptography::Encrypt Data::RSA (C0027.011)](../micro-behaviors/cryptography/encrypt-data.md)|Emotet uses RSA to encrypt network traffic to its C2. [[2]](#2)|
|[Discovery::Analysis Tool Discovery::Process detection - Debuggers (B0013.002)](../discovery/analysis-tool-discovery.md)|If it receives a response from the C2 server stating a debugging-related tool is in the list of running processes, it receives an "upgrade" command which calls the ShellExecuteW function and exits. [[3]](#3)|
|[Anti-Behavioral Analysis::Virtual Machine Detection::Guest Process Testing (B0009.010)](../anti-behavioral-analysis/virtual-machine-detection.md)|Emotet checks for various processes that are associated with various virtual machines by comparing hash values of the process names with the hash values of the list of running process names. [[4]](#4)|
|[Command and Control::C2 Communication::Request Email Address List (B0030.010)](../command-and-control/c2-communication.md)|New email addresses are collected automatically from the victim's address books. [[4]](#4)|
|[Execution::Send Email (B0020)](../execution/send-email.md)|Spam email with the Emotet loader is sent automatically. [[4]](#4)|
|[Micro-Behaviors::Communication::HTTP Communication::Create Request (C0002.012)](../micro-behaviors/communication/http-communication.md)|Emotet creates a HTTP request. [[6]](#6)|
|[Micro-Behaviors::Cryptography::Encrypt Data::RC4 (C0027.009)](../micro-behaviors/cryptography/encrypt-data.md)|Emotet encrypts data using RC4 PRGA. [[6]](#6)|
|[Discovery::Code Discovery::Enumerate PE Sections (B0046.001)](../discovery/code-discovery.md)|Emotet enumerates PE sections. [[6]](#6)|


## Indicators of Compromise

SHA256 Hashes
- eea5a1c7b3cc8350f8d5a95b6e2b7e3701d22cb362f8b988e815789f95c32eca

## References

<a name="1">[1]</a> https://cofense.com/recent-geodo-malware-campaigns-feature-heavily-obfuscated-macros/

<a name="2">[2]</a> https://documents.trendmicro.com/assets/white_papers/ExploringEmotetsActivities_Final.pdf

<a name="3">[3]</a> https://www.fortinet.com/blog/threat-research/deep-analysis-of-new-emotet-variant-part-1

<a name="4">[4]</a> https://securelist.com/the-banking-trojan-emotet-detailed-analysis/69560/

<a name="5">[5]</a> https://www.f-secure.com/v-descs/trojan_w32_emotet.shtml

<a name="6">[6]</a> capa v4.0, analyzed at MITRE on 10/12/2022


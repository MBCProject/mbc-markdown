<table>
<tr>
<td><b>ID</b></td>
<td><b>X0032</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2019</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b><a href="https://attack.mitre.org/software/S0366/">WannaCry</a></b></td>
</tr>
</table>

# WannaCry

WannaCry is ransomware that was first seen in a global attack during May 2017, which affected more than 150 countries. It contains worm-like features to spread itself across a computer network using the SMBv1 exploit EternalBlue. [[1]](#1)

## ATT&CK Techniques

|Name|Use|
|---|---|

|[ Create or Modify System Process: Windows Service (T1543)](https://attack.mitre.org/techniques/T1543/) |WannaCry creates the service "mssecsvc2.0" with the display name "Microsoft Security Center (2.0) Service."[ [[1]](#1)|
|[ Data Encrypted for Impact (T1486)](https://attack.mitre.org/techniques/T1486/) |WannaCry encrypts user files and demands that a ransom be paid in Bitcoin to decrypt those files. [[1]](#1)|

|[ Exploitation of Remote Services (T1210)](https://attack.mitre.org/techniques/T1210/) | WannaCry uses an exploit in SMBv1 to spread itself to other remote systems on a network.[[1]](#1)|
|[ File and Directory Discovery (T1083)](https://attack.mitre.org/techniques/T1083/) | WannaCry searches for variety of user files by file extension before encrypting them using RSA and AES, including Office, PDF, image, audio, video, source code, archive/compression format, and key and certificate files.[[[1]](#1)|


|[ 	Inhibit System Recovery (T1490)](https://attack.mitre.org/techniques/T1490/) |WannaCry uses vssadmin, wbadmin, bcdedit, and wmic to delete and disable operating system recovery features.[[[1]](#1)|
|[ 	Lateral Tool Transfer (T1570)](https://attack.mitre.org/techniques/T1570/) | WannaCry attempts to copy itself to remote computers after gaining access via an SMB exploit.[[1]](#1)|
|[ Peripheral Device Discovery(T1573)](https://attack.mitre.org/techniques/T1573/) | 	
WannaCry contains a thread that will attempt to scan for new attached drives every few seconds. If one is identified, it will encrypt the files on the attached device[[1]](#1)|

|[ Remote System Discovery (T1018)](https://attack.mitre.org/techniques/T1018/) |	
WannaCry scans its local network segment for remote systems to try to exploit and copy itself to [[1]](#1)|
|[Service Stop (T1489)](https://attack.mitre.org/techniques/T1489/) | WannaCry attempts to kill processes associated with Exchange, Microsoft SQL Server, and MySQL to make it possible to encrypt their data stores [[1]](#1)|
|[ System Network Configuration Discovery (T1016)](https://attack.mitre.org/techniques/T1016/) | WannaCry will attempt to determine the local network segment it is a part of [[1]](#1)|
|[ Windows Management Instrumentation (T1047)](https://attack.mitre.org/techniques/T1047/) | WannaCry utilizes wmic to delete shadow copies [[1]](#1)|
|[ Exploitation of Remote Services (T0866)](https://attack.mitre.org/techniques/T0866/) | 	
WannaCry initially infected IT networks, but by means of an exploit (particularly the SMBv1-targeting MS17-010 vulnerability) spread to industrial networks.  [[1]](#1)|
|[ Lateral Tool Transfer (T0867)](https://attack.mitre.org/techniques/T0867/) | 	
WannaCry can move laterally through industrial networks by means of the SMB service.[[1]](#1)|



## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[ File and Directory Permissions Modification: Windows File and Directory Permissions Modification (T1222.001)](https://attack.mitre.org/techniques/T1222/001) WannaCry uses attrib +h and icacls . /grant Everyone:F /T /C /Q to make some of its files hidden and grant all users full access controls.| [[1]](#1)|
|[	Hide Artifacts: Hidden Files and Directories(T1564.001)](https://attack.mitre.org/techniques/T1564/001) | WannaCry uses attrib +h to make some of its files hidden[[1]](#1)|
|[ Encrypted Channel: Asymmetric Cryptography (T1573.002)](https://attack.mitre.org/techniques/T1573/002) | WannaCry uses Tor for command and control traffic and routes a custom cryptographic protocol over the Tor circuit.[[1]](#1)|
|[ Proxy: Multi-hop Proxy (T1120.003)](https://attack.mitre.org/techniques/T1120/003) | 	
WannaCry uses Tor for command and control traffic [[1]](#1)|
|[ Remote Service Session Hijacking: RDP Hijacking (T1563.002)](https://attack.mitre.org/techniques/T1563/002) | WannaCry enumerates current remote desktop sessions and tries to execute the malware on each session[[1]](#1)|
|[ Proxy: Multi-hop Proxy (T1120.003)](https://attack.mitre.org/techniques/T1120/003) |WannaCry uses Tor for command and control traffic. [[1]](#1)|




## MBC Behaviors

|Name|Use|
|---|---|

|[Discovery::Self Discovery (B0038) ](../discovery/self-discovery.md) | The malware expects that the file it loads into memory to of side 0x30C[[2]](#2)|
|[Impact::Data Encrypted for Impact (B0025) ](../impact/data-encrypted-for-impact.md) | The malware encrypts files  for a ransom.[[2]](#2)|
|[Execution::Conditional Execution (B0038) ](../discovery/self-discovery.md) | The malware looks for http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com. If this DNS entry exists, the malware terminates and self deletes.[[2]](#2)|
|[Persistance::Registry Run Keys (F0012)](../persistence/registry-run-keys-startup-folder.md) |The malware creates the following two registry run keys to ensure persistence: Key: HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\<Random> Value: <Full_path>\tasksche.exe Key: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\<Random> Value: <Full_path>\tasksche.exe|

## Indicators of Compromise

MD5 Hashes
- db349b97c37d22f5ea1d1841e3c89eb4
- 84c82835a5d21bbcf75a61706d8ab549
- f351e1fcca0c4ea05fc44d15a17f8b36
- 7bf2b57f2a205768755c07f238fb32cc


## References

<a name="1">[1]</a> https://attack.mitre.org/software/S0366/

<a name="2">[2]</a> https://www.mandiant.com/resources/blog/wannacry-malware-profile
<table>
<tr>
<td><b>ID</b></td>
<td><b>X0043</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2017</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b><a href="https://attack.mitre.org/software/S0366">WannaCry</a></b></td>
</tr>
</table>

# WannaCry

WannaCry is ransomware that was first seen in a global attack during May 2017, which affected more than 150 countries. It contains worm-like features to spread across a computer network using the SMBv1 exploit EternalBlue. [[1]](#1)

## ATT&CK Techniques

See ATT&CK: [WannaCry - Techniques Used](https://attack.mitre.org/software/S0366/).

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Defense Evasion:: Hidden Files and Directories(F0005.003)](../defense-evasion/hidden-files-and-directories.md)|WannaCry uses the +h attribute to hide its files. [[1]](#1)|
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|WannaCry creates two registry run keys to ensure persistence. [[1]](#1)|
|[Defense-Evasion::Self Deletion (F0007)](../defense-evasion/self-deletion.md)|WannaCry looks for a DNS entry and if the entry exists, it terminates and deletes itself. [[1]](#1)|

## MBC Behaviors

|Name|Use|
|---|---|
|[Discovery::Self Discovery (B0038)](../discovery/self-discovery.md)|WannaCry checks the size of the file it loads into memory. [[1]](#1)|
|[Discovery::Self Discovery (B0038.002)](../discovery/self-discovery.md)|WannaCry checks a string, keylen and a magic number before decrypting a dll. [[1]](#1)|
|[Discovery::Self Discovery (B0038.003)](../discovery/self-discovery.md)|WannaCry checks the data lengh of a section before decypting a dll. [[1]](#1)|
|[Impact::Data Encrypted for Impact (B0025)](../impact/data-encrypted-for-impact.md)|WannaCry encrypts files for ransom. [[1]](#1)|


## Indicators of Compromise

MD5 Hashes
- db349b97c37d22f5ea1d1841e3c89eb4
- 84c82835a5d21bbcf75a61706d8ab549
- f351e1fcca0c4ea05fc44d15a17f8b36
- 7bf2b57f2a205768755c07f238fb32cc

## References

<a name="1">[1]</a> https://www.mandiant.com/resources/blog/wannacry-malware-profile
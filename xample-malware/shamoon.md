
<table>
<tr>
<td><b>ID</b></td>
<td><b>X0018</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2012</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b><a href="https://attack.mitre.org/software/S0140/">Shamoon</a></b></td>
</tr>
</table>


Shamoon
=======
Data wiping malware.


ATT&CK Techniques
-----------------
See ATT&CK: [Shamoon - Techniques Used](https://attack.mitre.org/software/S0140/).

Enhanced ATT&CK Techniques
---------
|Name|Use|
|---|---|
|[Impact::Data Destruction (E1485)](../impact/data-destruction.md)|A 2018 variant includes a component that erases files and then wipes the master boot record, preventing file recovery [[1]](#1)|
|[Persistence::Modify Existing Service (F0011)](../persistence/modify-existing-service.md)|Shamoon enables the RemoteRegistry service to allow remote registry modification [[2]](#2)|
|[Defense Evasion::Modify Registry (E1112)](../defense-evasion/modify-registry.md)|Disables remote user account control by enabling the registry key LocalAccountTokenFilterPolicy  [[2]](#2)|
|[Defense Evasion::Hidden Files and Directories::Timestamp (F0005.004)](../defense-evasion/hidden-files-and-directories.md)|Modifies target files' time to August 2012 as an antiforensic trick  [[2]](#2)|
|[Defense Evasion::Hijack Execution Flow::Abuse Windows Function Calls (F0015.006)](../defense-evasion/hijack-execution-flow.md)|Escalates privilege by impersonating the token. First uses LogonUser and ImpersonateLoggedOnUser, then ImpersonateNamedPipeClient. [[2]](#2)|
|[Impact::Disk Wipe (F0014)](../impact/disk-wipe.md)|An overwrite component will overwrite the MBR so that the compromised computer can no longer start  [[4]](#4)|
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|The wiper component of Shamoon creates a service to run the driver with the command: sc create hdv_725x type= kernel start= demand binpath= WINDOWS\hdv_725x.sys 2>&1 >nul and sends an additional reboot command after completion [[2]](#2)|
|[Command and Control::Ingress Tool Transfer (E1105)](../command-and-control/ingress-tool-transfer.md)|Creates a folder on remote computers and then copies its executables (Shamoon and Filerase) into that directory  [[3]](#3)|

Indicators of Compromise
------------------------
SHA256 Hashes
- c617120895646f73bc880c0aca18990deda3db9be03f6b3564013e26dedfa3f9

References
----------
<a name="1">[1]</a> https://www.darkreading.com/attacks-breaches/disk-wiping-shamoon-malware-resurfaces-with-file-erasing-malware-in-tow

<a name="2">[2]</a> https://www.mcafee.com/blogs/other-blogs/mcafee-labs/shamoon-returns-to-wipe-systems-in-middle-east-europe/

<a name="3">[3]</a> https://www.mcafee.com/blogs/other-blogs/mcafee-labs/shamoon-attackers-employ-new-tool-kit-to-wipe-infected-systems/

<a name="4">[4]</a> https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=281521ea-2d18-4bf9-9e88-8b1dc41cfdb6&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments

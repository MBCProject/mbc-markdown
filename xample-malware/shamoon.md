<table>
<tr>
<td><b>ID</b></td>
<td><b>X0018</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2012</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b><a href="https://attack.mitre.org/software/S0140/">Shamoon</a></b></td>
</tr>
</table>


# Shamoon

Data wiping malware.


## ATT&CK Techniques

|Name|Use|
|---|---|
|[Discovery::Process Discovery (T1057)](https://attack.mitre.org/techniques/T1057)|Enumerate processes (This capa rule had 1 match) [[5]](#5) |
|[Execution::Shared Modules (T1129)](https://attack.mitre.org/techniques/T1129)|Link many functions at runtime (This capa rule had 1 match) [[5]](#5) |
|[Execution::System Services::Service Execution (T1569.002)](https://attack.mitre.org/techniques/T1569/002)|Create service (This capa rule had 1 match) [[5]](#5) |
|[Persistence::Create or Modify System Process::Windows Service (T1543.003)](https://attack.mitre.org/techniques/T1543/003)|Start service (This capa rule had 1 match) [[5]](#5) |

See ATT&CK: [Shamoon - Techniques Used](https://attack.mitre.org/software/S0140/).

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Impact::Data Destruction (E1485)](../impact/data-destruction.md)|A 2018 variant includes a component that erases files and then wipes the master boot record, preventing file recovery [[1]](#1) |
|[Persistence::Modify Existing Service (F0011)](../persistence/modify-existing-service.md)|Shamoon enables the RemoteRegistry service to allow remote registry modification [[2]](#2) |
|[Defense Evasion::Modify Registry (E1112)](../defense-evasion/modify-registry.md)|Disables remote user account control by enabling the registry key LocalAccountTokenFilterPolicy  [[2]](#2) |
|[Defense Evasion::Hidden Files and Directories::Timestamp (F0005.004)](../defense-evasion/hidden-files-and-directories.md)|Modifies target files' time to August 2012 as an antiforensic trick  [[2]](#2) |
|[Defense Evasion::Hijack Execution Flow::Abuse Windows Function Calls (F0015.006)](../defense-evasion/hijack-execution-flow.md)|Escalates privilege by impersonating the token. First uses LogonUser and ImpersonateLoggedOnUser, then ImpersonateNamedPipeClient. [[2]](#2) |
|[Impact::Disk Wipe (F0014)](../impact/disk-wipe.md)|An overwrite component will overwrite the MBR so that the compromised computer can no longer start  [[4]](#4) |
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|The wiper component of Shamoon creates a service to run the driver with the command: sc create hdv_725x type= kernel start= demand binpath= WINDOWS\hdv_725x.sys 2>&1 >nul and sends an additional reboot command after completion [[2]](#2) |
|[Command and Control::Ingress Tool Transfer (E1105)](../command-and-control/ingress-tool-transfer.md)|Creates a folder on remote computers and then copies its executables (Shamoon and Filerase) into that directory  [[3]](#3) |
|[Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm (E1027.m02)](../defense-evasion/obfuscated-files-or-information.md)|Encode data using XOR (This capa rule had 1 match) [[5]](#5) |
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|Get common file path (This capa rule had 1 match) [[5]](#5) |
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|Get hostname (This capa rule had 1 match) [[5]](#5) |
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|Accept command line arguments (This capa rule had 1 match) [[5]](#5) |

## MBC Behaviors

|Name|Use|
|---|---|
|[Anti-Behavioral Analysis::Conditional Execution::Runs as Service (B0025.007)](../execution/conditional-execution.md)|Run as service (This capa rule had 1 match) [[5]](#5) |
|[Communication::DNS Communication::Resolve (C0011.001)](../micro-behaviors/communication/dns-communication.md)|Resolve DNS (This capa rule had 1 match) [[5]](#5) |
|[Communication::Socket Communication::Initialize Winsock Library (C0001.009)](../micro-behaviors/communication/socket-communication.md)|Initialize Winsock library (This capa rule had 1 match) [[5]](#5) |
|[Data::Encode Data::XOR (C0026.002)](../micro-behaviors/data/encode-data.md)|Encode data using XOR (This capa rule had 1 match) [[5]](#5) |
|[File System::Copy File (C0045)](../micro-behaviors/file-system/copy-file.md)|Copy file (This capa rule had 2 matches) [[5]](#5) |
|[File System::Delete File (C0047)](../micro-behaviors/file-system/delete-file.md)|Delete file (This capa rule had 6 matches) [[5]](#5) |
|[File System::Move File (C0063)](../micro-behaviors/file-system/move-file.md)|Move file (This capa rule had 2 matches) [[5]](#5) |
|[File System::Read File (C0051)](../micro-behaviors/file-system/read-file.md)|Read file on Windows (This capa rule had 1 match) [[5]](#5) |
|[File System::Write File (C0052)](../micro-behaviors/file-system/write-file.md)|Write file on Windows (This capa rule had 1 match) [[5]](#5) |
|[Operating System::Registry::Delete Registry Value (C0036.007)](../micro-behaviors/operating-system/registry.md)|Delete registry value (This capa rule had 1 match) [[5]](#5) |
|[Operating System::Registry::Query Registry Value (C0036.006)](../micro-behaviors/operating-system/registry.md)|Query or enumerate registry value (This capa rule had 1 match) [[5]](#5) |
|[Process::Allocate Thread Local Storage (C0040)](../micro-behaviors/process/allocate-thread-local-storage.md)|Allocate thread local storage (This capa rule had 1 match) [[5]](#5) |
|[Process::Create Process (C0017)](../micro-behaviors/process/create-process.md)|Create process on Windows (This capa rule had 2 matches) [[5]](#5) |
|[Process::Create Thread (C0038)](../micro-behaviors/process/create-thread.md)|Create thread (This capa rule had 2 matches) [[5]](#5) |
|[Process::Terminate Process (C0018)](../micro-behaviors/process/terminate-process.md)|Terminate process (This capa rule had 1 match) [[5]](#5) |

## Indicators of Compromise

SHA256 Hashes
- c617120895646f73bc880c0aca18990deda3db9be03f6b3564013e26dedfa3f9
- 4f02a9fcd2deb3936ede8ff009bd08662bdb1f365c0f4a78b3757a98c2f40400

## References

<a name="1">[1]</a> https://www.darkreading.com/attacks-breaches/disk-wiping-shamoon-malware-resurfaces-with-file-erasing-malware-in-tow

<a name="2">[2]</a> https://www.mcafee.com/blogs/other-blogs/mcafee-labs/shamoon-returns-to-wipe-systems-in-middle-east-europe/

<a name="3">[3]</a> https://www.mcafee.com/blogs/other-blogs/mcafee-labs/shamoon-attackers-employ-new-tool-kit-to-wipe-infected-systems/

<a name="4">[4]</a> https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=281521ea-2d18-4bf9-9e88-8b1dc41cfdb6&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments

<a name="5">[5]</a> capa v4.0, analyzed at MITRE on 10/12/2022


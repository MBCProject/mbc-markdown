<table>
<tr>
<td><b>ID</b></td>
<td><b>X0027</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2011</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b>None</b></td>
</tr>
</table>


# Redhip

Redhip is an information stealer.

## ATT&CK Techniques

|Name|Use|
|---|---|
|[Credential Access::Credentials from Password Stores::Windows Credential Manager (T1555.004)](https://attack.mitre.org/techniques/T1555/004)|Redhip acquires credentials from Windows Credential Manager. [[2]](#2)|
|[Defense Evasion::File and Directory Permissions Modification (T1222)](https://attack.mitre.org/techniques/T1222)|Redhip sets file attributes. [[2]](#2)|
|[Defense Evasion::Virtualization/Sandbox Evasion::System Checks (T1497.001)](https://attack.mitre.org/techniques/T1497/001)|Redhip references anti-VM strings targeting VirtualBox. [[2]](#2)|
|[Discovery::Account Discovery (T1087)](https://attack.mitre.org/techniques/T1087)|Redhip gets a user security identifier. [[2]](#2)|
|[Discovery::System Owner/User Discovery (T1033)](https://attack.mitre.org/techniques/T1033)|Redhip gets a session user name. [[2]](#2)|
|[Execution::Shared Modules (T1129)](https://attack.mitre.org/techniques/T1129)|Redhip accesses PEB ldr_data. [[2]](#2)|


## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Anti-Static Analysis::Software Packing (F0001)](../anti-static-analysis/software-packing.md)|Redhip samples are packed with different custom packers. [[1]](#1)|
|[Collection::Keylogging::Application Hook (F0002.001)](../collection/keylogging.md)|Redhip logs keystrokes via application hook. [[2]](#2)|
|[Collection::Keylogging::Polling (F0002.002)](../collection/keylogging.md)|Redhip logs keystrokes via polling. [[2]](#2)|
|[Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm (E1027.m02)](../defense-evasion/obfuscated-files-or-information.md)|Redhip encodes data using XOR. [[2]](#2)|
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|Redhip gets a file size. [[2]](#2)|
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|Redhip persists via a Run registry key. [[2]](#2)|
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|Redhip checks the OS version. [[2]](#2)|
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|Redhip accepts command line arguments. [[2]](#2)|
|[Defense Evasion::Process Injection::Thread Execution Hijacking (E1055.003)](../defense-evasion/process-injection.md)|Redhip injects threads. [[2]](#2)|

## MBC Behaviors

|Name|Use|
|---|---|
|[Anti-Behavioral Analysis::Sandbox Detection::Product Key/ID Testing (B0007.005)](../anti-behavioral-analysis/sandbox-detection.md#b0007005)|Redhip detects all publicly available automated malware analysis workbenches (ThreatExpert, JoeBox, etc.) by considering OS product keys and special DLLs and checks for sandboxes and AV modules. [[1]](#1) [[2]](#2)|
|[Anti-Behavioral Analysis::Virtual Machine Detection (B0009)](../anti-behavioral-analysis/virtual-machine-detection.md)|Redhip detects VMWare, Virtual PC, and Virtual Box. It also detects VM environments in general by considering time lapses. [[1]](#1)|
|[Anti-Behavioral Analysis::Debugger Detection (B0001)](../anti-behavioral-analysis/debugger-detection.md)|Redhip uses general approaches to detecting user level debuggers (e.g., Process Environment Block 'Being Debugged' field), as well as specific checks for kernel level debuggers like SOFTICE. [[1]](#1)|
|[Anti-Behavioral Analysis::Debugger Evasion (B0002)](../anti-behavioral-analysis/debugger-evasion.md)|Redhip uses general approaches to detecting user level debuggers (e.g., Process Environment Block 'Being Debugged' field), as well as specific checks for kernel level debuggers like SOFTICE. [[1]](#1)|
|[Anti-Behavioral Analysis::Debugger Detection::Process Environment Block BeingDebugged (B0001.035)](../anti-behavioral-analysis/debugger-detection.md)|Redhip checks for PEB BeingDebugged flag. [[2]](#2)|
|[Anti-Behavioral Analysis::Debugger Detection::Timing/Delay Check GetTickCount (B0001.032)](../anti-behavioral-analysis/debugger-detection.md)|Redhip checks for time delay via GetTickCount. [[2]](#2)|
|[Micro-Behaviors::Cryptography::Cryptographic Hash (C0029)](../micro-behaviors/cryptography/cryptographic-hash.md)|Redhip hashes data via WinCrypt. [[2]](#2)|
|[Micro-Behaviors::Cryptography::Cryptographic Hash::SHA1 (C0029.002)](../micro-behaviors/cryptography/cryptographic-hash.md)|Redhip hashes data using SHA1. [[2]](#2)|
|[Micro-Behaviors::Cryptography::Encrypt Data (C0027)](../micro-behaviors/cryptography/encrypt-data.md)|Redhip encrypts data using DPAPI. [[2]](#2)|
|[Micro-Behaviors::Data::Encode Data::XOR (C0026.002)](../micro-behaviors/data/encode-data.md)|Redhip encodes data using XOR. [[2]](#2)|
|[Discovery::Code Discovery::Inspect Section Memory Permissions (B0046.002)](../discovery/code-discovery.md)|Redhip inspects section memory permissions. [[2]](#2)|
|[Discovery::Taskbar Discovery (B0043)](../discovery/taskbar-discovery.md)|Redhip finds taskbars. [[2]](#2)|
|[Execution::Install Additional Program (B0023)](../execution/install-additional-program.md)|Redhip contains an embedded PE file. [[2]](#2)|
|[Micro-Behaviors::File System::Copy File (C0045)](../micro-behaviors/file-system/copy-file.md)|Redhip copies files. [[2]](#2)|
|[Micro-Behaviors::File System::Create Directory (C0046)](../micro-behaviors/file-system/create-directory.md)|Redhip creates directories. [[2]](#2)|
|[Micro-Behaviors::File System::Delete File (C0047)](../micro-behaviors/file-system/delete-file.md)|Redhip deletes files. [[2]](#2)|
|[Micro-Behaviors::File System::Get File Attributes (C0049)](../micro-behaviors/file-system/get-file-attributes.md)|Redhip gets file attributes. [[2]](#2)|
|[Micro-Behaviors::File System::Read File (C0051)](../micro-behaviors/file-system/read-file.md)|Redhip reads files on Windows. [[2]](#2)|
|[Micro-Behaviors::File System::Set File Attributes (C0050)](../micro-behaviors/file-system/set-file-attributes.md)|Redhip sets file attributes. [[2]](#2)|
|[Micro-Behaviors::File System::Write File (C0052)](../micro-behaviors/file-system/writes-file.md)|Redhip writes files on Windows. [[2]](#2)|
|[Micro-Behaviors::Memory::Allocate Memory (C0007)](../micro-behaviors/memory/allocate-memory.md)|Redhip spawns threads to RWX shellcode. [[2]](#2)|
|[Micro-Behaviors::Operating System::Registry::Delete Registry Key (C0036.002)](../micro-behaviors/operating-system/registry.md)|Redhip deletes registry keys. [[2]](#2)|
|[Micro-Behaviors::Operating System::Registry::Query Registry Value (C0036.006)](../micro-behaviors/operating-system/registry.md)|Redhip queries or enumerates registry values. [[2]](#2)|
|[Micro-Behaviors::Operating System::Registry::Set Registry Key (C0036.001)](../micro-behaviors/operating-system/registry.md)|Redhip sets registry values. [[2]](#2)|
|[Micro-Behaviors::Process::Create Mutex (C0042)](../micro-behaviors/process/create-mutex.md)|Redhip creates a mutex. [[2]](#2)|
|[Micro-Behaviors::Process::Create Process (C0017)](../micro-behaviors/process/create-process.md)|Redhip creates a process on Windows. [[2]](#2)|
|[Micro-Behaviors::Process::Create Process::Create Suspended Process (C0017.003)](../micro-behaviors/process/create-process.md)|Redhip creates a suspended process. [[2]](#2)|
|[Micro-Behaviors::Process::Set Thread Local Storage Value (C0041)](../micro-behaviors/process/set-thread-local-storage-value.md)|Redhip sets thread local storage values. [[2]](#2)|


## Indicators of Compromise

SHA256 Hashes
- 07b8f25e7b536f5b6f686c12d04edc37e11347c8acd5c53f98a174723078c365
- 65853e6a70b50166b2e2bd1e163d420d1184ff865183c5f68d8e8bb83eff3e6d

## References

<a name="1">[1]</a> Atif Mushtaq, FireEye, "The Dead Giveaways of VM-Aware Malware," 27 January 2011. https://web.archive.org/web/20161025013916/https:/www.fireeye.com/blog/threat-research/2011/01/the-dead-giveaways-of-vm-aware-malware.html

<a name="2">[2]</a> capa v4.0, analyzed at MITRE on 10/12/2022


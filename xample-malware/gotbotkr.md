|||
|---|---|
|**ID**|**X0027**|
|**Aliases**||
|**Platforms**|Windows|
|**Year**|2019|
|**Associated ATT&CK Software**|None|


GotBotKR
========
Modified version of a publicly available backdoor name GoBot2. Modifications are mainly evasion techniques specific to South Korea. [[1]](#1)

From [[1]](#1), “The malware installs two instances of itself on the system. The second instance (watchdog) monitors whether the first instance is still active and reinstalls it if it has been removed from the system.”


ATT&CK Techniques
-----------------
|Name|Use|
|---|---|
|[Initial Access::Drive-by Compromise (T1189)](https://attack.mitre.org/techniques/T1189/)|GoBotKR has been distributed through torrent file-sharing websites to South Korean victims, using games or Korean movie/TV series as a lure. [[1]](#1)|
|[Persistence::Scheduled Task (T1053)](https://attack.mitre.org/techniques/T1053/)|GoBotKR schedules a task that adds a registry run key to establish malware persistence. [[1]](#1)|
|[Privilege Escalation::Abuse Elevation Control Mechanism::Bypass User Account Control (T1548.002)](https://attack.mitre.org/techniques/T1548/002/)|GoBotKR attempts to bypass UAC using Registry Hijacking. [[1]](#1)|
|[Defense Evasion::Deobfuscate/Decode Files or Information (T1140)](https://attack.mitre.org/techniques/T1140/)|GoBotKR has used base64 to obfuscate strings, commands and files. [[1]](#1)|
|[Defense Evasion::Indicator Removal on Host (T1070)](https://attack.mitre.org/techniques/T1070/)|GoBotKR removes the Zone identifier from the ADS (Alternate Data Streams) of the file, to conceal the fact the file has been downloaded from the internet. [[1]](#1)|
|[Defense Evasion::Masquerading (T1036)](https://attack.mitre.org/techniques/T1036/)| GoBotKR uses filenames and registry key names associated with legitimate software. [[1]](#1)|
|[Discovery::Software Discovery: Security Software Discovery (T1518.001)](https://attack.mitre.org/techniques/T1518/001/)|GoBotKR checks for processes associated with security products and debugging tools, and terminates itself if any are detected. It can enumerate installed antivirus software using the wmic command. [[1]](#1)|
|[Discovery::System Information Discovery (T1082)](https://attack.mitre.org/techniques/T1082/)|GoBotKR uses wmic, systeminfo and ver commands to collect information about the system and the installed software. [[1]](#1)|
|[Discovery::System Network Configuration Discovery (T1016)](https://attack.mitre.org/techniques/T1016/)|GoBotKR uses netsh and ipconfig to collect information about the network configuration. It has used Naver and Daum portals to obtain the client IP address. [[1]](#1)|
|[Discovery::System Owner/User Discovery (T1033)](https://attack.mitre.org/techniques/T1033/)|GoBotKR uses whoami to obtain information about the victimized user. It runs tests to determine the privilege level of the compromised user. [[1]](#1)|
|[Discovery::System Time Discovery  (T1124)](https://attack.mitre.org/techniques/T1124/)| GoBotKR can obtain the date and time of the compromised system. [[1]](#1)|
|[Lateral Movement::Remote File Copy  (T1105)](https://attack.mitre.org/techniques/T1105/)| GoBotKR attempts to copy itself into public folders of cloud storage services (Google Drive, Dropbox, OneDrive). [[1]](#1)|
|[Lateral Movement::Replication Through Removable Media (T1091)](https://attack.mitre.org/techniques/T1091/)|GoBotKR can drop itself onto removable media and relies on Autorun to execute the malicious file when a user opens the removable media on another system. [[1]](#1)|
|[Command and Control::Connection Proxy (T1090)](https://attack.mitre.org/techniques/T1090/)|GoBotKR can be used as a proxy server. [[1]](#1)|
|[Command and Control::Data Encoding (T1132)](https://attack.mitre.org/techniques/T1132/)|The communication with the C&C server is base64 encoded. [[1]](#1)|
|[Command and Control::Remote File Copy (T1105)](https://attack.mitre.org/techniques/T1105/)|GoBotKR can download additional files and update itself. [[1]](#1)|
|[Command and Control::Standard Application Layer Protocol (T1071)](https://attack.mitre.org/techniques/T1071/)|GoBotKR uses HTTP or HTTPS for C&C. [[1]](#1)|
|[Command and Control::Uncommonly Used Port (T1571)](https://attack.mitre.org/techniques/T1571/)|GoBotKR uses non-standard ports, such as 6446, 6556 and 7777, for C&C. [[1]](#1)|

Behaviors
---------
|Name|Use|
|---|---|
|[Execution::Install Additional Program](../execution/install-additional-program.md)|GotBotKR reinstalls its running instance if it is removed. [[1]](#1)|
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|GoBotKR uses cmd.exe to execute commands. [[1]](#1)|
|[Persistence::Registry Run Keys/Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)| GoBotKR installs itself under registry run keys to establish persistence. [[1]](#1)|
|[Defense Evasion::Hidden Files and Directories (F0005)](../defense-evasion/hidden-files-and-directories.md)| GoBotKR stores itself in a file with Hidden and System attributes. [[1]](#1)|
|[Defense Evasion::Obfuscated Files or Information (E1027)](../defense-evasion/obfuscated-files-or-information.md)|GoBotKR uses base64 to obfuscate strings, commands and files. [[1]](#1)|
|[Defense Evasion::Modify Registry (E1112)](../defense-evasion/modify-registry.md)|GoBotKR can modify registry keys to disable Task Manager, Registry Editor and Command Prompt. [[1]](#1)|
|[Anti-Behavioral-Analysis::Detect Sandbox (B0007)](../anti-behavioral-analysis/sandbox-detection.md)|GoBotKR performs several checks on the compromised machine to avoid being emulated or executed in a sandbox. [[1]](#1)|
|[Collection::Screen Capture (E1113)](../collection/screen-capture.md)| GoBotKR is capable of capturing screenshots. [[1]](#1)|
|[Command and Control::Command and Control Communication::Receive Data (B0030.002)](../command-and-control/c2-communication.md)|GoBotKR receives data from the C2 [[1]](#1)|
|[Impact::Denial of Service (B0033)](../impact/denial-of-service.md)|GoBotKR has been used to execute endpoint DDoS attacks – for example, TCP Flood or SYN Flood. [[1]](#1)|
|[Impact::Resource Hijacking (B0018)](../impact/resource-hijacking.md)|GoBotKR can use the compromised computer’s network bandwidth to seed torrents or execute DDoS. [[1]](#1)|
|[Execution::User Interaction (E1204)](../execution/user-execution.md)| GoBotKR makes their malware look like the torrent content that the user intended to download, in order to entice a user to click on it. [[1]](#1)|

References
----------
<a name="1">[1]</a> https://www.welivesecurity.com/2019/07/08/south-korean-users-backdoor-torrents/

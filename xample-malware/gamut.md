<table>
<tr>
<td><b>ID</b></td>
<td><b>X0006</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>Bobax</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2014</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b>None</b></td>
</tr>
</table>


# Gamut

A spamming botnet.


## ATT&CK Techniques

|Name|Use|
|---|---|
|[Command and Control::Ingress Tool Transfer (T1105)](https://attack.mitre.org/techniques/T1105/)|The malware receives files from C2 [[1]](#1) |
|[Command and Control::Application Layer Protocol::Web Protocols (T1071.001)](https://attack.mitre.org/techniques/T1071/001/)|The malware uses HTTP for command and control [[1]](#1) |
|[Defense Evasion::File and Directory Permissions Modification (T1222)](https://attack.mitre.org/techniques/T1222)|Set file attributes (This capa rule had 2 matches) [[3]](#3) |
|[Defense Evasion::Modify Registry (T1112)](https://attack.mitre.org/techniques/T1112)|Delete registry key (This capa rule had 3 matches) [[3]](#3) |
|[Defense Evasion::Obfuscated Files or Information (T1027)](https://attack.mitre.org/techniques/T1027)|Encode data using XOR (This capa rule had 1 match) [[3]](#3) |
|[Discovery::File and Directory Discovery (T1083)](https://attack.mitre.org/techniques/T1083)|Get common file path (This capa rule had 5 matches) [[3]](#3) |
|[Discovery::Query Registry (T1012)](https://attack.mitre.org/techniques/T1012)|Query or enumerate registry key (This capa rule had 1 match) [[3]](#3) |
|[Discovery::System Information Discovery (T1082)](https://attack.mitre.org/techniques/T1082)|Query environment variable (This capa rule had 1 match) [[3]](#3) |
|[Execution::Command and Scripting Interpreter (T1059)](https://attack.mitre.org/techniques/T1059)|Accept command line arguments (This capa rule had 1 match) [[3]](#3) |
|[Execution::Shared Modules (T1129)](https://attack.mitre.org/techniques/T1129)|Link function at runtime on Windows (This capa rule had 1 match) [[3]](#3) |

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Defense Evasion::Modify Registry (E1112)](../defense-evasion/modify-registry.md)|The malware adds a registry key [[1]](#1) |
|[Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm (E1027.m02)](../defense-evasion/obfuscated-files-or-information.md)|Encode data using XOR (This capa rule had 1 match) [[3]](#3) |
|[Discovery::Application Window Discovery::Window Text (E1010.m01)](../discovery/application-window-discovery.md)|Get graphical window text (This capa rule had 1 match) [[3]](#3) |

## MBC Behaviors

|Name|Use|
|---|---|
|[Execution::Send Email (B0020)](../execution/send-email.md)|Gamut probes the infected system's SMTP port 25 by sending a test SMTP transaction to mail.ru and hotmail.com. If port 25 is open, the bot requests the spam template and email list, which it uses to send spam. [[1]](#1) |
|[Anti-Behavioral-Analysis::Debugger Detection::Interruption (B0001.006)](../anti-behavioral-analysis/debugger-detection.md)|The malware detects debuggers using an INT 03h trap [[1]](#1) |
|[Anti-Behavioral-Analysis::Debugger Detection::IsDebuggerPresent (B0001.008)](../anti-behavioral-analysis/debugger-detection.md)|The malware detects debuggers using IsDebuggerPresent [[1]](#1) |
|[Command and Control::Command and Control Communication::Receive Data (B0030.002)](../command-and-control/c2-communication.md)|The malware receives data from C2 [[1]](#1) |
|[Execution::Send Email (B0020)](../execution/send-email.md)|Gamut probes the infected system's SMTP port 25 by sending a test SMTP transaction to mail.ru and hotmail.com. [[1]](#1) |
|[Impact::Spamming (B0039)](../impact/spamming.md)|If port 25 is open, the bot uses a spam template and email list to send spam. [[1]](#1) |
|[Data::Checksum::CRC32 (C0032.001)](../micro-behaviors/data/checksum.md)|Hash data with CRC32 (This capa rule had 1 match) [[3]](#3) |
|[Data::Encode Data::XOR (C0026.002)](../micro-behaviors/data/encode-data.md)|Encode data using XOR (This capa rule had 1 match) [[3]](#3) |
|[Discovery::Code Discovery::Enumerate PE Sections (B0046.001)](../discovery/code-discovery.md)|Enumerate PE sections (This capa rule had 1 match) [[3]](#3) |
|[Execution::Install Additional Program (B0023)](../execution/install-additional-program.md)|Contain an embedded PE file (This capa rule had 1 match) [[3]](#3) |
|[File System::Create Directory (C0046)](../micro-behaviors/file-system/create-directory.md)|Create directory (This capa rule had 1 match) [[3]](#3) |
|[File System::Delete Directory (C0048)](../micro-behaviors/file-system/delete-directory.md)|Delete directory (This capa rule had 1 match) [[3]](#3) |
|[File System::Delete File (C0047)](../micro-behaviors/file-system/delete-file.md)|Delete file (This capa rule had 4 matches) [[3]](#3) |
|[File System::Get File Attributes (C0049)](../micro-behaviors/file-system/get-file-attributes.md)|Get file attributes (This capa rule had 10 matches) [[3]](#3) |
|[File System::Move File (C0063)](../micro-behaviors/file-system/move-file.md)|Move file (This capa rule had 1 match) [[3]](#3) |
|[File System::Read File (C0051)](../micro-behaviors/file-system/read-file.md)|Read file on Windows (This capa rule had 2 matches) [[3]](#3) |
|[File System::Set File Attributes (C0050)](../micro-behaviors/file-system/set-file-attributes.md)|Set file attributes (This capa rule had 2 matches) [[3]](#3) |
|[File System::Writes File(C0052)](../micro-behaviors/file-system/writes-file.md)|Writes file on Windows (This capa rule had 3 matches) [[3]](#3) |
|[Operating System::Registry::Delete Registry Key (C0036.002)](../micro-behaviors/operating-system/registry.md)|Delete registry key (This capa rule had 3 matches) [[3]](#3) |
|[Operating System::Registry::Delete Registry Value (C0036.007)](../micro-behaviors/operating-system/registry.md)|Delete registry value (This capa rule had 1 match) [[3]](#3) |
|[Operating System::Registry::Query Registry Key (C0036.005)](../micro-behaviors/operating-system/registry.md)|Query or enumerate registry key (This capa rule had 1 match) [[3]](#3) |
|[Operating System::Registry::Query Registry Value (C0036.006)](../micro-behaviors/operating-system/registry.md)|Query or enumerate registry value (This capa rule had 2 matches) [[3]](#3) |
|[Operating System::Registry::Set Registry Key (C0036.001)](../micro-behaviors/operating-system/registry.md)|Set registry value (This capa rule had 3 matches) [[3]](#3) |
|[Process::Create Process (C0017)](../micro-behaviors/process/create-process.md)|Create process on Windows (This capa rule had 4 matches) [[3]](#3) |
|[Process::Set Thread Local Storage Value (C0041)](../micro-behaviors/process/set-thread-local-storage-value.md)|Set thread local storage value (This capa rule had 1 match) [[3]](#3) |

## Indicators of Compromise

SHA256 Hashes
- a56162bc623841102301df8e5c918f27fe8c2a58ae049d81c838fcf256654932
- 1a9c4807500d25e83c456185a6b4571108e0f00c45667b520725ca8ae6f34fa4

## References

<a name="1">[1]</a> https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/gamut-spambot-analysis/

<a name="2">[2]</a> https://any.run/report/a56162bc623841102301df8e5c918f27fe8c2a58ae049d81c838fcf256654932/1a6f6db3-83d5-442e-8f0d-42cfab2e0d34

<a name="3">[3]</a> capa v4.0, analyzed at MITRE on 10/12/2022


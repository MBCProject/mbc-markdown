<table>
<tr>
<td><b>ID</b></td>
<td><b>X0027</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2019</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b>None</b></td>
</tr>
</table>


# GoBotKR

GoBotKR is a modified version of a publicly available backdoor, GoBot2. The modifications to GoBot2 are mainly evasion techniques specific to South Korea. [[1]](#1)

From [[1]](#1), “The malware installs two instances of itself on the system. The second instance (watchdog) monitors whether the first instance is still active and reinstalls it if it has been removed from the system.”


## ATT&CK Techniques

|Name|Use|
|---|---|
|[Initial Access::Drive-by Compromise (T1189)](https://attack.mitre.org/techniques/T1189/)|GoBotKR has been distributed through torrent file-sharing websites to South Korean victims, using games or Korean movie/TV series as a lure. [[1]](#1)|
|[Persistence::Scheduled Task (T1053)](https://attack.mitre.org/techniques/T1053/)|GoBotKR schedules a task that adds a registry run key to establish malware persistence. [[1]](#1)|
|[Privilege Escalation::Abuse Elevation Control Mechanism::Bypass User Account Control (T1548.002)](https://attack.mitre.org/techniques/T1548/002/)|GoBotKR attempts to bypass UAC using Registry Hijacking. [[1]](#1)|
|[Defense Evasion::Deobfuscate/Decode Files or Information (T1140)](https://attack.mitre.org/techniques/T1140/)|GoBotKR has used base64 to obfuscate strings, commands and files. [[1]](#1)|
|[Defense Evasion::Indicator Removal (T1070)](https://attack.mitre.org/techniques/T1070/)|GoBotKR removes the Zone identifier from the ADS (Alternate Data Streams) of the file, to conceal the fact the file has been downloaded from the internet. [[1]](#1)|
|[Defense Evasion::Masquerading (T1036)](https://attack.mitre.org/techniques/T1036/)|GoBotKR uses filenames and registry key names associated with legitimate software. [[1]](#1)|
|[Discovery::Software Discovery::Security Software Discovery (T1518.001)](https://attack.mitre.org/techniques/T1518/001/)|GoBotKR checks for processes associated with security products and debugging tools, and terminates itself if any are detected. It can enumerate installed antivirus software using the wmic command. [[1]](#1)|
|[Discovery::System Information Discovery (T1082)](https://attack.mitre.org/techniques/T1082/)|GoBotKR uses wmic, systeminfo and ver commands to collect information about the system and the installed software. [[1]](#1)|
|[Discovery::System Network Configuration Discovery (T1016)](https://attack.mitre.org/techniques/T1016/)|GoBotKR uses netsh and ipconfig to collect information about the network configuration. It has used Naver and Daum portals to obtain the client IP address. [[1]](#1)|
|[Discovery::System Owner/User Discovery (T1033)](https://attack.mitre.org/techniques/T1033/)|GoBotKR uses whoami to obtain information about the victimized user. It runs tests to determine the privilege level of the compromised user. [[1]](#1)|
|[Discovery::System Time Discovery (T1124)](https://attack.mitre.org/techniques/T1124/)|GoBotKR can obtain the date and time of the compromised system. [[1]](#1)|
|[Lateral Movement::Ingress Tool Transfer (T1105)](https://attack.mitre.org/techniques/T1105/)| GoBotKR attempts to copy itself into public folders of cloud storage services (Google Drive, Dropbox, OneDrive). [[1]](#1)|
|[Lateral Movement::Replication Through Removable Media (T1091)](https://attack.mitre.org/techniques/T1091/)|GoBotKR can drop itself onto removable media and relies on Autorun to execute the malicious file when a user opens the removable media on another system. [[1]](#1)|
|[Command and Control::Proxy (T1090)](https://attack.mitre.org/techniques/T1090/)|GoBotKR can be used as a proxy server. [[1]](#1)|
|[Command and Control::Data Encoding (T1132)](https://attack.mitre.org/techniques/T1132/)|The communication with the C&C server is Base64 encoded. [[1]](#1)|
|[Command and Control::Ingress Tool Transfer (T1105)](https://attack.mitre.org/techniques/T1105/)|GoBotKR can download additional files and update itself. [[1]](#1)|
|[Command and Control::Application Layer Protocol (T1071)](https://attack.mitre.org/techniques/T1071/)|GoBotKR uses HTTP or HTTPS for C&C. [[1]](#1)|
|[Command and Control::Non-Standard Port (T1571)](https://attack.mitre.org/techniques/T1571/)|GoBotKR uses non-standard ports, such as 6446, 6556 and 7777, for C&C. [[1]](#1)|


## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|GoBotKR uses cmd.exe to execute commands. [[1]](#1)|
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|GoBotKR installs itself under registry run keys to establish persistence. [[1]](#1)|
|[Defense Evasion::Hidden Files and Directories (F0005)](../defense-evasion/hidden-files-and-directories.md)|GoBotKR stores itself in a file with Hidden and System attributes. [[1]](#1)|
|[Defense Evasion::Obfuscated Files or Information (E1027)](../defense-evasion/obfuscated-files-or-information.md)|GoBotKR uses base64 to obfuscate strings, commands and files. [[1]](#1)|
|[Defense Evasion::Modify Registry (E1112)](../defense-evasion/modify-registry.md)|GoBotKR can modify registry keys to disable Task Manager, Registry Editor and Command Prompt. [[1]](#1)|
|[Collection::Screen Capture (E1113)](../collection/screen-capture.md)|GoBotKR is capable of capturing screenshots. [[1]](#1)|
|[Execution::User Execution (E1204)](../execution/user-execution.md)|GoBotKR makes their malware look like the torrent content that the user intended to download, in order to entice a user to click on it. [[1]](#1)|
|[Command and Control::Ingress Tool Transfer (E1105)](../command-and-control/ingress-tool-transfer.md)|GoBotKR can download additional files and update itself. [[1]](#1) |
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|GoBotKR uses wmic, systeminfo, and ver commands to collect information about the system and the installed software and queries environment variables. [[1]](#1) [[2]](#2)|
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|GoBotKR checks if a file exists. [[2]](#2)|


## MBC Behaviors

|Name|Use|
|---|---|
|[Execution::Install Additional Program (B0023)](../execution/install-additional-program.md)|GoBotKR reinstalls its running instance if it is removed. [[1]](#1)|
|[Anti-Behavioral-Analysis::Sandbox Detection (B0007)](../anti-behavioral-analysis/sandbox-detection.md)|GoBotKR performs several checks on the compromised machine to avoid being emulated or executed in a sandbox. [[1]](#1)|
|[Command and Control::C2 Communication::Receive Data (B0030.002)](../command-and-control/c2-communication.md)|GoBotKR receives data from the C2. [[1]](#1) [[2]](#2)|
|[Impact::Denial of Service (B0033)](../impact/denial-of-service.md)|GoBotKR has been used to execute endpoint DDoS attacks – for example, TCP Flood or SYN Flood. [[1]](#1)|
|[Impact::Resource Hijacking (B0018)](../impact/resource-hijacking.md)|GoBotKR can use the compromised computer’s network bandwidth to seed torrents or execute DDoS. [[1]](#1)|
|[Micro-Behaviors::File System::Copy File (C0045)](../micro-behaviors/file-system/copy-file.md)|GoBotKR copies files. [[2]](#2)|
|[Micro-Behaviors::File System::Create Directory (C0046)](../micro-behaviors/file-system/create-directory.md)|GoBotKR creates directories. [[2]](#2)|
|[Micro-Behaviors::File System::Delete File (C0047)](../micro-behaviors/file-system/delete-file.md)|GoBotKR deletes files. [[2]](#2)|
|[Micro-Behaviors::Operating System::Registry::Query Registry Value (C0036.006)](../micro-behaviors/operating-system/registry.md)|GoBotKR queries or enumerates registry values. [[2]](#2)|
|[Micro-Behaviors::Process::Create Process (C0017)](../micro-behaviors/process/create-process.md)|GoBotKR creates processes on Windows. [[2]](#2)|
|[Micro-Behaviors::Process::Create Thread (C0038)](../micro-behaviors/process/create-thread.md)|GoBotKR creates threads. [[2]](#2)|
|[Micro-Behaviors::Process::Suspend Thread (C0055)](../micro-behaviors/process/suspend-thread.md)|GoBotKR suspends threads. [[2]](#2)|
|[Micro-Behaviors::Process::Terminate Process (C0018)](../micro-behaviors/process/terminate-process.md)|GoBotKR terminates processes. [[2]](#2)|


## Indicators of Compromise

SHA256 Hashes
- 492e8ee240492768232b717a60a880f216fd936b6ed9f5b6f67fe83db3bbc7d4
- d4420f7f6fbc361bac02bcd9d994703735b15da80775ee20862db47b59d521d6

## References

<a name="1">[1]</a> https://www.welivesecurity.com/2019/07/08/south-korean-users-backdoor-torrents/

<a name="2">[2]</a> capa v4.0, analyzed at MITRE on 10/12/2022


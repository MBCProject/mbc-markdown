<table>
<tr>
<td><b>ID</b></td>
<td><b>X0009</b></td>
</tr>
<tr>
<td><b>Aliases</b></td>
<td><b>None</b></td>
</tr>
<tr>
<td><b>Platforms</b></td>
<td><b>Windows</b></td>
</tr>
<tr>
<td><b>Year</b></td>
<td><b>2016</b></td>
</tr>
<tr>
<td><b>Associated ATT&CK Software</b></td>
<td><b>None</b></td>
</tr>
</table>


# Kovter

A trojan that performs click-fraud.


## ATT&CK Techniques

|Name|Use|
|---|---|
|[Initial Access::Phishing::Spearphishing Attachment (T1566.001)](https://attack.mitre.org/techniques/T1566/001/)|The malware is sent out to victims via an attachment [[2]](#2) |
|[Execution::User Execution::Malicious File (T1204.002)](https://attack.mitre.org/techniques/T1204/002/)|The malware relies on a victim to execute itself [[2]](#2) |
|[Defense Evasion::System Binary Proxy Execution::Mshta (T1218.005)](https://attack.mitre.org/techniques/T1218/005/)|The malware uses mshta.exe to run Javascript [[1]](#1) |
|[Defense Evasion::File and Directory Permissions Modification (T1222)](https://attack.mitre.org/techniques/T1222)|Set file attributes (This capa rule had 3 matches) [[3]](#3) |
|[Discovery::Application Window Discovery (T1010)](https://attack.mitre.org/techniques/T1010)|Find graphical window (This capa rule had 11 matches) [[3]](#3) |
|[Discovery::System Location Discovery (T1614)](https://attack.mitre.org/techniques/T1614)|Get geographical location (This capa rule had 1 match) [[3]](#3) |
|[Execution::Shared Modules (T1129)](https://attack.mitre.org/techniques/T1129)|Get ntdll base address (This capa rule had 2 matches) [[3]](#3) |
|[Execution::System Services::Service Execution (T1569.002)](https://attack.mitre.org/techniques/T1569/002)|Interact with driver via control codes (This capa rule had 3 matches) [[3]](#3) |

## Enhanced ATT&CK Techniques

|Name|Use|
|---|---|
|[Impact::Generate Traffic from Victim (E1643)](../impact/generate-traffic-from-victim.md)|Performs click-fraud. [[1]](#1) |
|[Persistence::Registry Run Keys / Startup Folder (F0012)](../persistence/registry-run-keys-startup-folder.md)|The malware writes an autorun registry entry [[2]](#2) |
|[Execution::Command and Scripting Interpreter (E1059)](../execution/command-and-scripting-interpreter.md)|The malware executes malicious javascript and powershell [[1]](#1) |
|[Defense Evasion::Modify Registry (E1112)](../defense-evasion/modify-registry.md)|The malware modifies the registry during execution [[2]](#2) |
|[Defense Evasion::Obfuscated Files or Information (E1027)](../defense-evasion/obfuscated-files-or-information.md)|The malware will use a key to decrypt text from a URL to create more malicious code [[1]](#1) |
|[Anti-Static Analysis::Software Packing (F0001)](../anti-static-analysis/software-packing.md)|The malware comes packed by a crypter/FUD [[1]](#1) |
|[Collection::Keylogging::Polling (F0002.002)](../collection/keylogging.md)|Log keystrokes via polling (This capa rule had 1 match) [[3]](#3) |
|[Collection::Screen Capture::WinAPI (E1113.m01)](../collection/screen-capture.md)|Capture screenshot (This capa rule had 1 match) [[3]](#3) |
|[Discovery::Application Window Discovery::Window Text (E1010.m01)](../discovery/application-window-discovery.md)|Get graphical window text (This capa rule had 2 matches) [[3]](#3) |
|[Discovery::File and Directory Discovery::Log File (E1083.m01)](../discovery/file-and-directory-discovery.md)|Access the Windows event log (This capa rule had 2 matches) [[3]](#3) |
|[Discovery::File and Directory Discovery (E1083)](../discovery/file-and-directory-discovery.md)|Get file version info (This capa rule had 3 matches) [[3]](#3) |
|[Discovery::System Information Discovery (E1082)](../discovery/system-information-discovery.md)|Get disk information (This capa rule had 1 match) [[3]](#3) |

## MBC Behaviors

|Name|Use|
|---|---|
|[Defense Evasion::Alternative Installation Location::Registry Install (B0027.002)](../defense-evasion/alternative-installation-location.md)|Stores malware files in the Registry instead of the hard drive [[2]](#2) |
|[Command And Control::C2 Communication::Receive Data (B0030.002)](../command-and-control/c2-communication.md)|Receive data (This capa rule had 16 matches) [[3]](#3) |
|[Command And Control::C2 Communication::Send Data (B0030.001)](../command-and-control/c2-communication.md)|Send data (This capa rule had 1 match) [[3]](#3) |
|[Communication::HTTP Communication::Connect to Server (C0002.009)](../micro-behaviors/communication/http-communication.md)|Connect to HTTP server (This capa rule had 2 matches) [[3]](#3) |
|[Communication::HTTP Communication::Create Request (C0002.012)](../micro-behaviors/communication/http-communication.md)|Create HTTP request (This capa rule had 4 matches) [[3]](#3) |
|[Cryptography::Cryptographic Hash (C0029)](../micro-behaviors/cryptography/cryptographic-hash.md)|Hash data via WinCrypt (This capa rule had 22 matches) [[3]](#3) |
|[Cryptography::Decrypt Data (C0031)](../micro-behaviors/cryptography/decrypt-data.md)|Encrypt or decrypt via WinCrypt (This capa rule had 1 match) [[3]](#3) |
|[Cryptography::Encryption Key (C0028)](../micro-behaviors/cryptography/encryption-key.md)|Create new key via CryptAcquireContext (This capa rule had 1 match) [[3]](#3) |
|[File System::Copy File (C0045)](../micro-behaviors/file-system/copy-file.md)|Copy file (This capa rule had 5 matches) [[3]](#3) |
|[File System::Create Directory (C0046)](../micro-behaviors/file-system/create-directory.md)|Create directory (This capa rule had 14 matches) [[3]](#3) |
|[File System::Delete Directory (C0048)](../micro-behaviors/file-system/delete-directory.md)|Delete directory (This capa rule had 4 matches) [[3]](#3) |
|[File System::Delete File (C0047)](../micro-behaviors/file-system/delete-file.md)|Delete file (This capa rule had 2 matches) [[3]](#3) |
|[File System::Move File (C0063)](../micro-behaviors/file-system/move-file.md)|Move file (This capa rule had 24 matches) [[3]](#3) |
|[File System::Read File (C0051)](../micro-behaviors/file-system/read-file.md)|Read file on Windows (This capa rule had 4 matches) [[3]](#3) |
|[File System::Set File Attributes (C0050)](../micro-behaviors/file-system/set-file-attributes.md)|Set file attributes (This capa rule had 3 matches) [[3]](#3) |
|[Operating System::Environment Variable::Set Variable (C0034.001)](../micro-behaviors/operating-system/environment-variable.md)|Set environment variable (This capa rule had 3 matches) [[3]](#3) |
|[Operating System::Registry::Create Registry Key (C0036.004)](../micro-behaviors/operating-system/registry.md)|Create or open registry key (This capa rule had 14 matches) [[3]](#3) |
|[Operating System::Registry::Query Registry Value (C0036.006)](../micro-behaviors/operating-system/registry.md)|Query or enumerate registry value (This capa rule had 2 matches) [[3]](#3) |
|[Process::Allocate Thread Local Storage (C0040)](../micro-behaviors/process/allocate-thread-local-storage.md)|Allocate thread local storage (This capa rule had 3 matches) [[3]](#3) |
|[Process::Create Mutex (C0042)](../micro-behaviors/process/create-mutex.md)|Create mutex (This capa rule had 2 matches) [[3]](#3) |
|[Process::Create Process (C0017)](../micro-behaviors/process/create-process.md)|Create process on Windows (This capa rule had 22 matches) [[3]](#3) |
|[Process::Set Thread Local Storage Value (C0041)](../micro-behaviors/process/set-thread-local-storage-value.md)|Set thread local storage value (This capa rule had 3 matches) [[3]](#3) |
|[Process::Terminate Process (C0018)](../micro-behaviors/process/terminate-process.md)|Terminate process (This capa rule had 6 matches) [[3]](#3) |

## Indicators of Compromise

SHA256 Hashes
- 15c237f6b74af2588b07912bf18e2734594251787871c9638104e4bf5de46589
- bffe7ccbcf69e7c787ff10d1dc7dbf6044bffcb13b95d851f4a735917b3a6fdf
- 40050153dceec2c8fbb1912f8eeabe449d1e265f0c8198008be8b34e5403e731

## References

<a name="1">[1]</a> https://blog.malwarebytes.com/threat-analysis/2016/07/untangling-kovter/

<a name="2">[2]</a> https://labs.vipre.com/analysis-of-kovter-a-very-clever-piece-of-malware/#:~:text=Kovter%20copies%20the%20fileless%20persistence,written%20on%20to%20the%20filesystem.

<a name="3">[3]</a> capa v4.0, analyzed at MITRE on 10/12/2022

